
> momentum-platform@9.6.0 test:all
> npm --prefix functions run test -- --runInBand --detectOpenHandles


> momentum-functions@1.0.0 test
> jest --config ./jest.config.js --runInBand --detectOpenHandles

npm : 
ts-jest[ts-jest-transformer] 
(WARN) Define `ts-jest` 
config under `globals` is 
deprecated. Please do
No linha:1 caractere:1
+ npm run test:all > 
test_results_v2.txt 2>&1
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~
    + CategoryInfo           
   : NotSpecified: (ts-jest  
  [ts-jest...ated. Please    
 do:String) [], RemoteExc    
eption
    + FullyQualifiedErrorId  
   : NativeCommandError
 
transform: {
    <transform_regex>: 
['ts-jest', { /* ts-jest 
config goes here in Jest */ 
}],
},
See more at https://kulshekha
r.github.io/ts-jest/docs/gett
ing-started/presets#advanced
FAIL 
tests/cfo-summary.test.ts
  ÔùÅ Test suite failed to 
run

    ReferenceError: Cannot 
access 'firebaseMock' before 
initialization

    [0m [90m 1 |[39m 
[36mimport[39m [33m*[39m 
[36mas[39m firebaseMock 
[36mfrom[39m [32m"./mocks/
firebase"[39m[33m;[39m
     [90m 2 |[39m
    
[31m[1m>[22m[39m[90m 3 
|[39m jest[33m.[39mmock([
32m"src/services/firebase"[3
9m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39mdb)[33m;[39m
     [90m   |[39m          
                             
                
[31m[1m^[22m[39m
     [90m 4 |[39m jest[33m
.[39mmock([32m"firebase-adm
in"[39m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39madmin)[33m;[39m
     [90m 5 |[39m[0m

      at tests/setupFirebaseM
ock.ts:3:55
      at Object.<anonymous> (
tests/setupFirebaseMock.ts:1:
1)
      at Object.<anonymous> 
(tests/setupTests.ts:1:1)

FAIL tests/compliance.test.ts
  ÔùÅ Test suite failed to 
run

    ReferenceError: Cannot 
access 'firebaseMock' before 
initialization

    [0m [90m 1 |[39m 
[36mimport[39m [33m*[39m 
[36mas[39m firebaseMock 
[36mfrom[39m [32m"./mocks/
firebase"[39m[33m;[39m
     [90m 2 |[39m
    
[31m[1m>[22m[39m[90m 3 
|[39m jest[33m.[39mmock([
32m"src/services/firebase"[3
9m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39mdb)[33m;[39m
     [90m   |[39m          
                             
                
[31m[1m^[22m[39m
     [90m 4 |[39m jest[33m
.[39mmock([32m"firebase-adm
in"[39m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39madmin)[33m;[39m
     [90m 5 |[39m[0m

      at tests/setupFirebaseM
ock.ts:3:55
      at Object.<anonymous> (
tests/setupFirebaseMock.ts:1:
1)
      at Object.<anonymous> 
(tests/setupTests.ts:1:1)

FAIL tests/billing.test.ts
  ÔùÅ Test suite failed to 
run

    ReferenceError: Cannot 
access 'firebaseMock' before 
initialization

    [0m [90m 1 |[39m 
[36mimport[39m [33m*[39m 
[36mas[39m firebaseMock 
[36mfrom[39m [32m"./mocks/
firebase"[39m[33m;[39m
     [90m 2 |[39m
    
[31m[1m>[22m[39m[90m 3 
|[39m jest[33m.[39mmock([
32m"src/services/firebase"[3
9m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39mdb)[33m;[39m
     [90m   |[39m          
                             
                
[31m[1m^[22m[39m
     [90m 4 |[39m jest[33m
.[39mmock([32m"firebase-adm
in"[39m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39madmin)[33m;[39m
     [90m 5 |[39m[0m

      at tests/setupFirebaseM
ock.ts:3:55
      at Object.<anonymous> (
tests/setupFirebaseMock.ts:1:
1)
      at Object.<anonymous> 
(tests/setupTests.ts:1:1)

FAIL 
tests/public-signup.test.ts
  ÔùÅ Test suite failed to 
run

    ReferenceError: Cannot 
access 'firebaseMock' before 
initialization

    [0m [90m 1 |[39m 
[36mimport[39m [33m*[39m 
[36mas[39m firebaseMock 
[36mfrom[39m [32m"./mocks/
firebase"[39m[33m;[39m
     [90m 2 |[39m
    
[31m[1m>[22m[39m[90m 3 
|[39m jest[33m.[39mmock([
32m"src/services/firebase"[3
9m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39mdb)[33m;[39m
     [90m   |[39m          
                             
                
[31m[1m^[22m[39m
     [90m 4 |[39m jest[33m
.[39mmock([32m"firebase-adm
in"[39m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39madmin)[33m;[39m
     [90m 5 |[39m[0m

      at tests/setupFirebaseM
ock.ts:3:55
      at Object.<anonymous> (
tests/setupFirebaseMock.ts:1:
1)
      at Object.<anonymous> 
(tests/setupTests.ts:1:1)

FAIL tests/ai.test.ts
  ÔùÅ Test suite failed to 
run

    ReferenceError: Cannot 
access 'firebaseMock' before 
initialization

    [0m [90m 1 |[39m 
[36mimport[39m [33m*[39m 
[36mas[39m firebaseMock 
[36mfrom[39m [32m"./mocks/
firebase"[39m[33m;[39m
     [90m 2 |[39m
    
[31m[1m>[22m[39m[90m 3 
|[39m jest[33m.[39mmock([
32m"src/services/firebase"[3
9m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39mdb)[33m;[39m
     [90m   |[39m          
                             
                
[31m[1m^[22m[39m
     [90m 4 |[39m jest[33m
.[39mmock([32m"firebase-adm
in"[39m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39madmin)[33m;[39m
     [90m 5 |[39m[0m

      at tests/setupFirebaseM
ock.ts:3:55
      at Object.<anonymous> (
tests/setupFirebaseMock.ts:1:
1)
      at Object.<anonymous> 
(tests/setupTests.ts:1:1)

FAIL tests/withTenant-legacy-
status.test.ts
  ÔùÅ Test suite failed to 
run

    ReferenceError: Cannot 
access 'firebaseMock' before 
initialization

    [0m [90m 1 |[39m 
[36mimport[39m [33m*[39m 
[36mas[39m firebaseMock 
[36mfrom[39m [32m"./mocks/
firebase"[39m[33m;[39m
     [90m 2 |[39m
    
[31m[1m>[22m[39m[90m 3 
|[39m jest[33m.[39mmock([
32m"src/services/firebase"[3
9m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39mdb)[33m;[39m
     [90m   |[39m          
                             
                
[31m[1m^[22m[39m
     [90m 4 |[39m jest[33m
.[39mmock([32m"firebase-adm
in"[39m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39madmin)[33m;[39m
     [90m 5 |[39m[0m

      at tests/setupFirebaseM
ock.ts:3:55
      at Object.<anonymous> (
tests/setupFirebaseMock.ts:1:
1)
      at Object.<anonymous> 
(tests/setupTests.ts:1:1)

FAIL tests/utils.test.ts
  ÔùÅ Test suite failed to 
run

    ReferenceError: Cannot 
access 'firebaseMock' before 
initialization

    [0m [90m 1 |[39m 
[36mimport[39m [33m*[39m 
[36mas[39m firebaseMock 
[36mfrom[39m [32m"./mocks/
firebase"[39m[33m;[39m
     [90m 2 |[39m
    
[31m[1m>[22m[39m[90m 3 
|[39m jest[33m.[39mmock([
32m"src/services/firebase"[3
9m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39mdb)[33m;[39m
     [90m   |[39m          
                             
                
[31m[1m^[22m[39m
     [90m 4 |[39m jest[33m
.[39mmock([32m"firebase-adm
in"[39m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39madmin)[33m;[39m
     [90m 5 |[39m[0m

      at tests/setupFirebaseM
ock.ts:3:55
      at Object.<anonymous> (
tests/setupFirebaseMock.ts:1:
1)
      at Object.<anonymous> 
(tests/setupTests.ts:1:1)

FAIL tests/rateLimit.test.ts
  ÔùÅ Test suite failed to 
run

    ReferenceError: Cannot 
access 'firebaseMock' before 
initialization

    [0m [90m 1 |[39m 
[36mimport[39m [33m*[39m 
[36mas[39m firebaseMock 
[36mfrom[39m [32m"./mocks/
firebase"[39m[33m;[39m
     [90m 2 |[39m
    
[31m[1m>[22m[39m[90m 3 
|[39m jest[33m.[39mmock([
32m"src/services/firebase"[3
9m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39mdb)[33m;[39m
     [90m   |[39m          
                             
                
[31m[1m^[22m[39m
     [90m 4 |[39m jest[33m
.[39mmock([32m"firebase-adm
in"[39m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39madmin)[33m;[39m
     [90m 5 |[39m[0m

      at tests/setupFirebaseM
ock.ts:3:55
      at Object.<anonymous> (
tests/setupFirebaseMock.ts:1:
1)
      at Object.<anonymous> 
(tests/setupTests.ts:1:1)

FAIL 
tests/billing-usage.test.ts
  ÔùÅ Test suite failed to 
run

    ReferenceError: Cannot 
access 'firebaseMock' before 
initialization

    [0m [90m 1 |[39m 
[36mimport[39m [33m*[39m 
[36mas[39m firebaseMock 
[36mfrom[39m [32m"./mocks/
firebase"[39m[33m;[39m
     [90m 2 |[39m
    
[31m[1m>[22m[39m[90m 3 
|[39m jest[33m.[39mmock([
32m"src/services/firebase"[3
9m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39mdb)[33m;[39m
     [90m   |[39m          
                             
                
[31m[1m^[22m[39m
     [90m 4 |[39m jest[33m
.[39mmock([32m"firebase-adm
in"[39m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39madmin)[33m;[39m
     [90m 5 |[39m[0m

      at tests/setupFirebaseM
ock.ts:3:55
      at Object.<anonymous> (
tests/setupFirebaseMock.ts:1:
1)
      at Object.<anonymous> 
(tests/setupTests.ts:1:1)

FAIL 
tests/cfo-ai-report.test.ts
  ÔùÅ Test suite failed to 
run

    ReferenceError: Cannot 
access 'firebaseMock' before 
initialization

    [0m [90m 1 |[39m 
[36mimport[39m [33m*[39m 
[36mas[39m firebaseMock 
[36mfrom[39m [32m"./mocks/
firebase"[39m[33m;[39m
     [90m 2 |[39m
    
[31m[1m>[22m[39m[90m 3 
|[39m jest[33m.[39mmock([
32m"src/services/firebase"[3
9m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39mdb)[33m;[39m
     [90m   |[39m          
                             
                
[31m[1m^[22m[39m
     [90m 4 |[39m jest[33m
.[39mmock([32m"firebase-adm
in"[39m[33m,[39m () 
[33m=>[39m firebaseMock[33
m.[39madmin)[33m;[39m
     [90m 5 |[39m[0m

      at tests/setupFirebaseM
ock.ts:3:55
      at Object.<anonymous> (
tests/setupFirebaseMock.ts:1:
1)
      at Object.<anonymous> 
(tests/setupTests.ts:1:1)

Test Suites: 10 failed, 10 
total
Tests:       0 total
Snapshots:   0 total
Time:        8.148 s, 
estimated 9 s
Ran all test suites.
