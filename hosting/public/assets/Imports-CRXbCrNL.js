import{c as o,r as m,j as e,G as r,g as i,C as A,b as q,t as g}from"./index-CDF0DbQ4.js";import{S as z}from"./SectionHeader-CGDkteUz.js";import{A as b}from"./AsyncPanel-1CPXaLuI.js";import{B as N}from"./Badge-BdguWUD2.js";import{C as I}from"./circle-check-UswIaIm1.js";import{H as v}from"./history-D6y4heRL.js";const H=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],y=o("activity",H);const E=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],w=o("database",E);const L=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],P=o("file-text",L);const V=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],D=o("link-2",V);const $=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],k=o("upload",$);function X(){const[a,d]=m.useState(!1),[x,u]=m.useState(null),[c,h]=m.useState("sheets"),[l,S]=m.useState(""),[n,p]=m.useState(null);function C(t){return t.match(/\/d\/([^/]+)/)?.[1]??t.trim()}async function M(){const t=l.trim();if(t){d(!0),p(null),u(null);try{const s=C(t),{data:f}=await q.post("/sync/import",{sheetId:s}),j=f.importedCount??0,_=f.message??`Importação concluída: ${j} registros processados.`;p(_),g?.("import_sheets_success",{importedCount:j})}catch(s){console.error("[Imports] Erro Sheets:",s),u(s),g?.("import_sheets_error",{status:s?.status})}finally{d(!1)}}}return e.jsxs("div",{className:"space-y-6",children:[e.jsx(z,{title:"Importar Dados",description:"Central de sincronização e upload de arquivos financeiros."}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(r,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-momentum-accent/10 text-momentum-accent",children:e.jsx(k,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-lg font-semibold text-momentum-text",children:"Importar dados"})]}),e.jsxs("div",{className:"flex bg-momentum-accent/5 p-1 rounded-lg border border-white/5",children:[e.jsxs("button",{onClick:()=>h("sheets"),className:i("px-3 py-1.5 rounded-md text-xs font-medium transition-all flex items-center gap-2",c==="sheets"?"bg-momentum-accent text-white shadow-sm":"text-momentum-muted hover:text-momentum-text"),children:[e.jsx(w,{className:"w-3.5 h-3.5"}),"Google Sheets"]}),e.jsxs("button",{onClick:()=>h("file"),className:i("px-3 py-1.5 rounded-md text-xs font-medium transition-all flex items-center gap-2",c==="file"?"bg-momentum-accent text-white shadow-sm":"text-momentum-muted hover:text-momentum-text"),children:[e.jsx(k,{className:"w-3.5 h-3.5"}),"Arquivo"]})]})]}),c==="file"?e.jsxs("div",{className:i("border-2 border-dashed border-momentum-accent/20 rounded-xl p-10","flex flex-col items-center justify-center text-center transition-colors","hover:border-momentum-accent/40 bg-momentum-accent/5"),children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-momentum-accent/10 flex items-center justify-center mb-4 text-momentum-accent",children:e.jsx(P,{className:"w-6 h-6"})}),e.jsx("p",{className:"text-sm font-medium text-momentum-text mb-1",children:"Arraste um arquivo ou clique para selecionar"}),e.jsx("p",{className:"text-xs text-momentum-muted mb-6",children:"CSV, XLSX ou PDF (máx. 5MB)"}),e.jsxs("div",{className:"flex flex-col gap-3 w-full max-w-xs",children:[e.jsx("button",{type:"button",disabled:!0,className:"w-full py-2.5 px-4 rounded-xl bg-momentum-accent text-white font-medium text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Selecionar arquivo"}),e.jsx("div",{className:"flex items-center justify-center gap-2",children:e.jsx(N,{variant:"warn",children:"Em breve"})})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-medium text-momentum-text",children:"URL da Planilha Google"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(D,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-momentum-muted"}),e.jsx("input",{type:"url",value:l,onChange:t=>S(t.target.value),placeholder:"https://docs.google.com/spreadsheets/d/...",className:"w-full bg-momentum-accent/5 border border-white/10 rounded-xl pl-10 pr-4 py-2 text-sm text-momentum-text outline-none focus:ring-2 focus:ring-momentum-accent/50"})]}),e.jsx("button",{onClick:M,disabled:a||!l.trim(),className:"px-4 py-2 rounded-xl bg-momentum-accent text-white text-sm font-medium hover:bg-momentum-accent/90 transition-colors disabled:opacity-50",children:a?"Sincronizando...":"Sincronizar"})]})]}),n&&!x&&e.jsxs("div",{className:"p-3 rounded-lg bg-emerald-500/10 border border-emerald-500/20 flex gap-3",children:[e.jsx(I,{className:"w-4 h-4 text-emerald-500 shrink-0 mt-0.5"}),e.jsx("p",{className:"text-xs text-emerald-600 dark:text-emerald-400 font-medium",children:n})]}),e.jsx("p",{className:"text-[11px] text-momentum-muted leading-relaxed italic",children:"* Certifique-se de que a planilha possui cabeçalhos reconhecidos (Data, Descrição, Valor, Categoria)."})]}),e.jsx("div",{className:"mt-6 p-4 rounded-lg bg-slate-500/5 border border-white/5",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(A,{className:"w-4 h-4 text-momentum-accent shrink-0 mt-0.5"}),e.jsx("p",{className:"text-xs text-momentum-muted leading-relaxed line-clamp-2 hover:line-clamp-none cursor-help transition-all",children:"Para performance ideal, recomendamos arquivos com até 1.000 linhas por vez. Arquivos maiores que 5MB serão rejeitados pelo sistema."})]})}),!1]}),e.jsx(b,{loading:a&&c==="sheets",error:x,isEmpty:!a&&!n,emptyConfig:{title:"Aguardando importação",description:"Nenhum processamento ativo no momento.",icon:y},children:e.jsxs(r,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 rounded-lg bg-momentum-accent/10 text-momentum-accent",children:e.jsx(y,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-lg font-semibold text-momentum-text",children:"Status do Processamento"})]}),a&&e.jsxs("div",{className:"flex flex-col gap-4 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-momentum-accent/10 rounded w-3/4"}),e.jsx("div",{className:"h-2 bg-momentum-accent/5 rounded w-full"}),e.jsx("div",{className:"h-2 bg-momentum-accent/5 rounded w-1/2"})]}),n&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-momentum-accent/5 border border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{className:"w-4 h-4 text-momentum-accent"}),e.jsx("span",{className:"text-sm font-medium text-momentum-text",children:"Sincronização Finalizada"})]}),e.jsx(N,{variant:"success",children:"Sucesso"})]}),e.jsx("p",{className:"text-xs text-momentum-muted",children:n})]})]})})]}),e.jsx("div",{className:"h-full",children:e.jsx(b,{loading:!1,isEmpty:!0,emptyConfig:{title:"Nenhum histórico encontrado",description:"Você ainda não realizou nenhuma importação neste tenant.",icon:v,action:e.jsx("button",{className:"px-4 py-2 bg-momentum-accent/10 text-momentum-accent rounded-lg text-xs font-medium hover:bg-momentum-accent/20 transition-all",children:"Iniciar importação"})},children:e.jsx(r,{className:"p-6 h-full",children:e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-momentum-accent/10 text-momentum-accent",children:e.jsx(v,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-lg font-semibold text-momentum-text",children:"Histórico de Importações"})]})})})})})]})]})}export{X as default};
