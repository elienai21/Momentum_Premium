import{c as R,b as w,r as s,j as e,X as Z,M as ue,L as B,G as U,B as z,f as pe,h as X,T as he}from"./index-sZ5pzLG8.js";import{U as K}from"./user-B-qeH-DS.js";import{B as q,u as be}from"./useTenant-pcgbF3D7.js";import{P as Y}from"./plus-DanuC4Kd.js";import{U as fe,F as re}from"./upload-uy-6PD9v.js";import{D as ge}from"./download-BAvqDhZe.js";import{D as je}from"./dollar-sign-CfFip6Xp.js";import{C as ve}from"./circle-check-big-DLZxrb4g.js";import{S as ye}from"./SectionHeader-Dy6jrYS0.js";import{S as V}from"./StatsCard-BNiXgSc7.js";import{A as Ne}from"./AsyncPanel-NQt8qWDx.js";import{R as se}from"./refresh-cw-BejIcNON.js";import{C as ae}from"./circle-dollar-sign-DT-vAZRo.js";import{S as we}from"./search-CvjjDlxN.js";import"./rotate-ccw-3VMdqQvO.js";const ke=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],le=R("chevron-down",ke);const Se=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Q=R("chevron-right",Se);const Ce=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],J=R("house",Ce);const Ee=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],De=R("map-pin",Ee);const ze=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],Ie=R("percent",ze);const Pe=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Me=R("phone",Pe);const Ae=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ee=R("save",Ae);async function Ue(t=30){return(await w.get(`/realestate/portfolio-summary?days=${t}`)).data.summary}async function ne(){return(await w.get("/realestate/buildings")).data.buildings}async function Be(){return(await w.get("/realestate/units")).data.units}async function Re(){return(await w.get("/realestate/owners")).data.owners}async function $e(t){return(await w.post("/realestate/owners",t)).data.owner}async function Le(t){return(await w.post("/realestate/units",t)).data.unit}async function Te(t){return(await w.post("/realestate/buildings",t)).data.building}async function qe(t){return(await w.get("/realestate/contracts",{params:t?{unitId:t}:void 0})).data.contracts}async function _e(t){return(await w.post("/realestate/contracts",t)).data.contract}async function Fe(t,l){await w.put(`/realestate/contracts/${t}`,l)}const P={documents:{initUpload:async t=>(await w.post("/realestate/documents/init-upload",t)).data,commit:async t=>(await w.post("/realestate/documents/commit",t)).data,list:async t=>{const l=new URLSearchParams;return Object.entries(t||{}).forEach(([f,n])=>{n!=null&&n!==""&&l.append(f,String(n))}),(await w.get(`/realestate/documents${l.toString()?`?${l.toString()}`:""}`)).data.documents}},receivables:{generateBatch:async t=>(await w.post("/realestate/receivables/generate-batch",{period:t})).data,list:async t=>{const l=new URLSearchParams;return Object.entries(t||{}).forEach(([f,n])=>{n&&l.append(f,String(n))}),(await w.get(`/realestate/receivables${l.toString()?`?${l.toString()}`:""}`)).data.receivables},recordPayment:async(t,l,m)=>(await w.post(`/realestate/receivables/${t}/payment`,{amount:l,date:m})).data.receivable},analytics:{getAging:async()=>(await w.get("/realestate/analytics/aging")).data.aging},financial:{getReceivables:async()=>[],generateStatement:async(t,l)=>(await w.post("/realestate/statements/generate",{ownerId:t,period:l})).data,listStatements:async t=>(await w.get(`/realestate/statements?ownerId=${t}`)).data.statements}};function ie({onClose:t,onSuccess:l}){const[m,f]=s.useState(!1),[n,x]=s.useState({name:"",email:"",phone:""}),j=async i=>{if(i.preventDefault(),!!n.name.trim()){f(!0);try{await $e({name:n.name.trim(),email:n.email.trim()||void 0,phone:n.phone.trim()||void 0}),l(),t()}catch(u){console.error("Erro ao salvar proprietário:",u),alert("Erro ao salvar proprietário. Verifique os dados.")}finally{f(!1)}}};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-md rounded-2xl shadow-2xl overflow-hidden border border-slate-200 dark:border-slate-800 animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"relative bg-gradient-to-br from-primary via-primary/90 to-secondary p-6 text-white",children:[e.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-2 rounded-full bg-white/20 hover:bg-white/30 transition-colors",children:e.jsx(Z,{size:16})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center shadow-glow",children:e.jsx(K,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold font-display",children:"Novo Proprietário"}),e.jsx("p",{className:"text-white/80 text-sm font-display",children:"Cadastre um novo proprietário de imóveis"})]})]})]}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-5",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 dark:text-slate-500 tracking-widest flex items-center gap-1.5 font-display",children:[e.jsx(K,{size:12})," Nome Completo *"]}),e.jsx("input",{required:!0,type:"text",placeholder:"Ex: João da Silva",value:n.name,onChange:i=>x(u=>({...u,name:i.target.value})),className:"w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all font-display"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 dark:text-slate-500 tracking-widest flex items-center gap-1.5 font-display",children:[e.jsx(ue,{size:12})," Email"]}),e.jsx("input",{type:"email",placeholder:"Ex: joao@email.com",value:n.email,onChange:i=>x(u=>({...u,email:i.target.value})),className:"w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all font-display"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 dark:text-slate-500 tracking-widest flex items-center gap-1.5 font-display",children:[e.jsx(Me,{size:12})," Telefone"]}),e.jsx("input",{type:"tel",placeholder:"Ex: (11) 99999-9999",value:n.phone,onChange:i=>x(u=>({...u,phone:i.target.value})),className:"w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all font-display"})]}),e.jsxs("div",{className:"pt-2 flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 py-3 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 font-bold text-sm hover:bg-slate-200 dark:hover:bg-slate-700 transition-all font-display",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:m||!n.name.trim(),className:"flex-[2] py-3 rounded-xl bg-primary hover:bg-primary/90 text-white font-bold text-sm shadow-glow transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 font-display",children:[m?e.jsx(B,{size:18,className:"animate-spin"}):e.jsx(ee,{size:18}),"Salvar Proprietário"]})]})]})]})})}function oe({onClose:t,onSuccess:l}){const[m,f]=s.useState(!1),[n,x]=s.useState({name:"",address:"",city:"",zipCode:""}),j=async i=>{if(i.preventDefault(),!!n.name.trim()){f(!0);try{await Te({name:n.name.trim(),address:n.address.trim()||void 0,city:n.city.trim()||void 0,zipCode:n.zipCode.trim()||void 0,active:!0}),l(),t()}catch(u){console.error("Erro ao salvar edifício:",u),alert("Erro ao salvar edifício. Verifique os dados.")}finally{f(!1)}}};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-md rounded-2xl shadow-2xl overflow-hidden border border-slate-200 dark:border-slate-800 animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"relative bg-gradient-to-br from-slate-800 to-slate-900 p-6 text-white",children:[e.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-2 rounded-full bg-white/20 hover:bg-white/30 transition-colors",children:e.jsx(Z,{size:16})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary/30 flex items-center justify-center shadow-glow",children:e.jsx(q,{size:24,className:"text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold font-display",children:"Novo Edifício"}),e.jsx("p",{className:"text-white/80 text-sm font-display",children:"Cadastre um condomínio ou prédio"})]})]})]}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-5",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 dark:text-slate-500 tracking-widest flex items-center gap-1.5 font-display",children:[e.jsx(q,{size:12})," Nome do Edifício *"]}),e.jsx("input",{required:!0,type:"text",placeholder:"Ex: Condomínio Brera",value:n.name,onChange:i=>x(u=>({...u,name:i.target.value})),className:"w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all font-display"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 dark:text-slate-500 tracking-widest flex items-center gap-1.5 font-display",children:[e.jsx(De,{size:12})," Endereço"]}),e.jsx("input",{type:"text",placeholder:"Ex: Rua dos Imóveis, 123",value:n.address,onChange:i=>x(u=>({...u,address:i.target.value})),className:"w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all font-display"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400 dark:text-slate-500 tracking-widest font-display",children:"Cidade"}),e.jsx("input",{type:"text",placeholder:"Ex: São Paulo",value:n.city,onChange:i=>x(u=>({...u,city:i.target.value})),className:"w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all font-display"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400 dark:text-slate-500 tracking-widest font-display",children:"CEP"}),e.jsx("input",{type:"text",placeholder:"Ex: 01310-100",value:n.zipCode,onChange:i=>x(u=>({...u,zipCode:i.target.value})),className:"w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all font-display"})]})]}),e.jsxs("div",{className:"pt-2 flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 py-3 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 font-bold text-sm hover:bg-slate-200 dark:hover:bg-slate-700 transition-all font-display",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:m||!n.name.trim(),className:"flex-[2] py-3 rounded-xl bg-primary hover:bg-primary/90 text-white font-bold text-sm shadow-glow transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 font-display",children:[m?e.jsx(B,{size:18,className:"animate-spin"}):e.jsx(ee,{size:18}),"Salvar Edifício"]})]})]})]})})}function Oe({onClose:t,onSuccess:l}){const[m,f]=s.useState([]),[n,x]=s.useState([]),[j,i]=s.useState(!1),[u,y]=s.useState(!1),[k,N]=s.useState(!1),[S,o]=s.useState(!1),[a,v]=s.useState({code:"",name:"",buildingId:"",ownerId:""}),h=s.useCallback(async()=>{m.length===0&&n.length===0&&i(!0);try{const[g,p]=await Promise.all([ne(),Re()]);f(g),x(p)}catch(g){console.error("Erro ao carregar selects:",g)}finally{i(!1)}},[]);s.useEffect(()=>{h()},[h]);const I=async g=>{if(g.preventDefault(),!(!a.code||!a.ownerId)){y(!0);try{await Le({code:a.code,name:a.name,buildingId:a.buildingId||void 0,ownerId:a.ownerId,active:!0}),l(),t()}catch(p){console.error("Erro ao salvar unidade:",p),alert("Erro ao salvar unidade. Verifique os dados.")}finally{y(!1)}}};return e.jsxs("div",{className:"fixed inset-0 z-[50] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-300",children:[e.jsxs("div",{className:"bg-white w-full max-w-lg rounded-3xl shadow-2xl overflow-hidden border border-slate-200",children:[e.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-slate-900 text-white flex items-center justify-center",children:e.jsx(Y,{size:20})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 tracking-tight",children:"Nova Propriedade"}),e.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"Cadastre uma nova unidade ao seu portfólio."})]})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-200 rounded-full transition-colors text-slate-400",children:e.jsx(Z,{size:20})})]}),e.jsxs("form",{onSubmit:I,className:"p-8 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-widest flex items-center gap-1.5",children:[e.jsx(J,{size:12})," Código da Unidade"]}),e.jsx("input",{required:!0,type:"text",placeholder:"Ex: 1204-A",value:a.code,onChange:g=>v(p=>({...p,code:g.target.value})),className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-500/20 outline-none transition-all font-bold"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-widest",children:"Nome Amigável"}),e.jsx("input",{type:"text",placeholder:"Ex: Brera Moema",value:a.name,onChange:g=>v(p=>({...p,name:g.target.value})),className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-500/20 outline-none transition-all"})]})]}),e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-widest flex items-center gap-1.5",children:[e.jsx(q,{size:12})," Edifício (Opcional)"]}),e.jsxs("div",{className:"flex gap-2",children:[j?e.jsx("div",{className:"h-12 w-full bg-slate-100 animate-pulse rounded-xl"}):e.jsxs("select",{value:a.buildingId,onChange:g=>v(p=>({...p,buildingId:g.target.value})),className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-500/20 outline-none transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"",children:"Nenhum (Propriedade Avulsa)"}),m.map(g=>e.jsx("option",{value:g.id,children:g.name},g.id))]}),e.jsx("button",{type:"button",onClick:()=>o(!0),className:"p-3 bg-slate-100 border border-slate-200 rounded-xl hover:bg-white hover:border-slate-300 transition-all text-slate-500 hover:text-blue-600 shadow-sm",title:"Novo Edifício",children:e.jsx(Y,{size:18})})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-widest flex items-center gap-1.5",children:[e.jsx(K,{size:12})," Proprietário"]}),e.jsxs("div",{className:"flex gap-2",children:[j?e.jsx("div",{className:"h-12 w-full bg-slate-100 animate-pulse rounded-xl"}):e.jsxs("select",{required:!0,value:a.ownerId,onChange:g=>v(p=>({...p,ownerId:g.target.value})),className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-500/20 outline-none transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"",children:"Selecione..."}),n.map(g=>e.jsx("option",{value:g.id,children:g.name},g.id))]}),e.jsx("button",{type:"button",onClick:()=>N(!0),className:"p-3 bg-slate-100 border border-slate-200 rounded-xl hover:bg-white hover:border-slate-300 transition-all text-slate-500 hover:text-blue-600 shadow-sm",title:"Novo Proprietário",children:e.jsx(Y,{size:18})})]})]})]}),e.jsxs("div",{className:"pt-4 flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 py-3.5 rounded-2xl bg-slate-100 text-slate-600 font-bold text-sm hover:bg-slate-200 transition-all active:scale-95",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:u||!a.code||!a.ownerId,className:"flex-[2] py-3.5 rounded-2xl bg-blue-600 text-white font-bold text-sm hover:bg-blue-700 shadow-lg shadow-blue-500/20 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[u?e.jsx(B,{size:18,className:"animate-spin"}):e.jsx(ee,{size:18}),"Salvar Propriedade"]})]})]})]}),k&&e.jsx(ie,{onClose:()=>N(!1),onSuccess:h}),S&&e.jsx(oe,{onClose:()=>o(!1),onSuccess:h})]})}const Ve=[{value:"contract",label:"Contrato"},{value:"inspection",label:"Vistoria"},{value:"iptu",label:"IPTU"},{value:"other",label:"Outros"}];function Ge({isOpen:t,onClose:l,entityId:m,entityType:f,onSuccess:n}){const[x,j]=s.useState(null),[i,u]=s.useState(""),[y,k]=s.useState("contract"),[N,S]=s.useState(""),[o,a]=s.useState(!1),[v,h]=s.useState(null);if(!t)return null;const I=()=>{j(null),u(""),k("contract"),S(""),h(null)},g=async p=>{if(p.preventDefault(),!x){h("Selecione um arquivo.");return}if(!i.trim()){h("Informe um título.");return}a(!0),h(null);try{const b=await P.documents.initUpload({linkedEntityType:f,linkedEntityId:m,fileName:x.name,mimeType:x.type||"application/octet-stream",sizeBytes:x.size,title:i,docType:y,validUntil:N||void 0}),E=await fetch(b.uploadUrl,{method:"PUT",headers:{"Content-Type":x.type||"application/octet-stream"},body:x});if(!E.ok)throw new Error(`Falha no upload (${E.status})`);const M=await P.documents.commit({uploadSessionId:b.uploadSessionId,storagePath:b.storagePath,linkedEntityType:f,linkedEntityId:m,fileName:x.name,mimeType:x.type||"application/octet-stream",sizeBytes:x.size,title:i,docType:y,validUntil:N||void 0});n(M.document),I(),l()}catch(b){h(b?.message||"Erro ao enviar documento")}finally{a(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/50 backdrop-blur-sm px-4",children:e.jsxs(U,{className:"w-full max-w-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-slate-400 font-semibold tracking-widest",children:"GED • Upload"}),e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Novo Documento"})]}),e.jsx(z,{variant:"neutral",className:"uppercase text-[10px]",children:f})]}),e.jsxs("form",{className:"space-y-4",onSubmit:g,children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500",children:"Arquivo (PDF/Imagem)"}),e.jsx("input",{type:"file",accept:".pdf,image/*",onChange:p=>j(p.target.files?.[0]||null),className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",disabled:o,required:!0}),x&&e.jsxs("p",{className:"text-[11px] text-slate-500",children:[x.name," • ",(x.size/1024).toFixed(1)," KB"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("label",{className:"text-xs font-semibold text-slate-500 flex flex-col gap-1",children:["Título",e.jsx("input",{type:"text",value:i,onChange:p=>u(p.target.value),className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",disabled:o,required:!0})]}),e.jsxs("label",{className:"text-xs font-semibold text-slate-500 flex flex-col gap-1",children:["Tipo de Documento",e.jsx("select",{value:y,onChange:p=>k(p.target.value),className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",disabled:o,children:Ve.map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))})]})]}),e.jsxs("label",{className:"text-xs font-semibold text-slate-500 flex flex-col gap-1",children:["Validade (opcional)",e.jsx("input",{type:"date",value:N,onChange:p=>S(p.target.value),className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",disabled:o})]}),v&&e.jsx("p",{className:"text-sm text-red-600",children:v}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>{I(),l()},className:"px-4 py-2 rounded-lg border border-slate-200 text-slate-600 text-sm font-semibold hover:bg-slate-50",disabled:o,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded-lg bg-blue-600 text-white text-sm font-bold shadow-sm hover:bg-blue-700 disabled:opacity-60",disabled:o,children:o?"Enviando...":"Salvar"})]})]})]})})}function de(){const{tenantId:t}=pe(),{role:l}=be(t||null),m=["admin","owner","finance","editor"].includes(l||""),f=["admin","owner","finance"].includes(l||"");return{canEdit:m,canManageFinance:f,role:l||"viewer"}}function He({entityId:t,entityType:l}){const[m,f]=s.useState([]),[n,x]=s.useState(!0),[j,i]=s.useState(null),[u,y]=s.useState(!1),{canEdit:k}=de(),N=async()=>{x(!0),i(null);try{const o=await P.documents.list({linkedEntityId:t,linkedEntityType:l});f(o)}catch(o){i(o?.message||"Erro ao carregar documentos")}finally{x(!1)}};s.useEffect(()=>{t&&N()},[t]);const S=o=>{f(a=>[o,...a])};return e.jsxs(U,{className:"p-4 border border-slate-200/70 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase text-slate-400 font-semibold tracking-widest",children:"GED"}),e.jsx("h4",{className:"text-lg font-bold text-slate-800",children:"Documentos da Unidade"})]}),k&&e.jsxs("button",{onClick:()=>y(!0),className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-600 text-white text-sm font-semibold shadow-sm hover:bg-blue-700",children:[e.jsx(fe,{size:16}),"Novo Documento"]})]}),n&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[e.jsx(B,{className:"h-4 w-4 animate-spin text-blue-600"}),"Carregando documentos..."]}),j&&e.jsx("p",{className:"text-sm text-red-600",children:j}),!n&&!j&&m.length===0&&e.jsx("p",{className:"text-sm text-slate-500",children:"Nenhum documento cadastrado para esta entidade."}),e.jsx("div",{className:"space-y-3",children:m.map(o=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-100 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-blue-50 text-blue-700 flex items-center justify-center",children:e.jsx(re,{size:18})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-800",children:o.title}),e.jsx(z,{variant:o.status==="active"?"success":"neutral",children:o.status==="active"?"Ativo":"Arquivado"}),e.jsxs(z,{variant:"neutral",children:["v",o.version]})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[o.docType," • ",o.fileName]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o.validUntil&&e.jsxs(z,{variant:"warn",className:"text-[10px]",children:["Validade ",o.validUntil]}),e.jsx("a",{href:o.downloadUrl||void 0,target:"_blank",rel:"noreferrer",className:`px-3 py-1.5 rounded-lg border text-sm font-semibold ${o.downloadUrl?"border-blue-200 text-blue-700 hover:bg-blue-50":"border-slate-200 text-slate-400 cursor-not-allowed"}`,onClick:a=>{o.downloadUrl||a.preventDefault()},children:o.downloadUrl?"Download":"Sem URL"})]})]},o.id))}),e.jsx(Ge,{isOpen:u,onClose:()=>y(!1),entityId:t,entityType:l,onSuccess:S})]})}const Ye=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t);function Je({ownerId:t}){const[l,m]=s.useState(()=>{const a=new Date;return`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`}),[f,n]=s.useState([]),[x,j]=s.useState(!1),[i,u]=s.useState(!1),[y,k]=s.useState(null),N=s.useMemo(()=>{const[a,v]=l.split("-");return`${v}/${a}`},[l]),S=async()=>{j(!0),k(null);try{const a=await P.financial.listStatements(t);n(a)}catch(a){k(a?.message||"Erro ao carregar extratos")}finally{j(!1)}};s.useEffect(()=>{t&&S()},[t]);const o=async()=>{u(!0),k(null);try{const a=await P.financial.generateStatement(t,l);a?.statement&&n(v=>[a.statement,...v.filter(h=>h.id!==a.statement.id)])}catch(a){k(a?.message||"Erro ao gerar extrato")}finally{u(!1)}};return e.jsxs(U,{className:"p-4 border border-slate-200/70 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase text-slate-400 font-semibold tracking-widest",children:"Extratos"}),e.jsx("h4",{className:"text-lg font-bold text-slate-800",children:"Prestação de Contas"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"month",value:l,onChange:a=>m(a.target.value),className:"rounded-lg border border-slate-200 px-3 py-2 text-sm"}),e.jsxs("button",{onClick:o,className:"px-4 py-2 rounded-lg bg-blue-600 text-white text-sm font-semibold shadow-sm hover:bg-blue-700 disabled:opacity-60 inline-flex items-center gap-2",disabled:i,children:[i&&e.jsx(B,{className:"h-4 w-4 animate-spin"}),"Gerar"]})]})]}),y&&e.jsx("p",{className:"text-sm text-red-600",children:y}),x&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[e.jsx(B,{className:"h-4 w-4 animate-spin text-blue-600"}),"Carregando extratos..."]}),!x&&!y&&f.length===0&&e.jsx("p",{className:"text-sm text-slate-500",children:"Nenhum extrato gerado para este proprietário."}),e.jsx("div",{className:"space-y-3",children:f.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-100 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-emerald-50 text-emerald-700 flex items-center justify-center",children:e.jsx(re,{size:18})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-800",children:a.period}),e.jsx(z,{variant:a.status==="ready"?"success":"warn",children:a.status==="ready"?"Pronto":"Falhou"})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Repasse líquido: ",Ye(a.totals.net||0)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{variant:"neutral",className:"text-[10px]",children:a.generatedAt?.slice(0,10)||N}),e.jsxs("a",{href:a.htmlUrl,target:"_blank",rel:"noreferrer",className:`inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border text-sm font-semibold ${a.htmlUrl?"border-emerald-200 text-emerald-700 hover:bg-emerald-50":"border-slate-200 text-slate-400 cursor-not-allowed"}`,onClick:v=>{a.htmlUrl||v.preventDefault()},children:[e.jsx(ge,{size:14}),"Ver/Imprimir"]})]})]},a.id))})]})}const W=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t);function G({label:t,value:l,color:m}){return e.jsxs("div",{className:`p-3 rounded-xl border ${m} bg-white`,children:[e.jsx("p",{className:"text-[11px] uppercase text-slate-400 font-semibold tracking-widest",children:t}),e.jsx("p",{className:"text-lg font-bold text-slate-800",children:W(l)})]})}function Ke({unitId:t,ownerId:l}){const[m,f]=s.useState([]),[n,x]=s.useState(null),[j,i]=s.useState(!1),[u,y]=s.useState(!1),[k,N]=s.useState(null),[S,o]=s.useState(()=>{const c=new Date;return`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}`}),[a,v]=s.useState(!1),{canManageFinance:h}=de(),I=s.useMemo(()=>{const c={};return t&&(c.unitId=t),l&&(c.ownerId=l),c},[t,l]),g=async()=>{i(!0),N(null);try{const c=await P.receivables.list(I);f(c)}catch(c){N(c?.message||"Erro ao carregar cobranças")}finally{i(!1)}},p=async()=>{y(!0);try{const c=await P.analytics.getAging();x(c)}catch{}finally{y(!1)}};s.useEffect(()=>{g(),p()},[I]);const b=async()=>{v(!0),N(null);try{await P.receivables.generateBatch(S),await g(),await p()}catch(c){N(c?.message||"Erro ao gerar cobranças")}finally{v(!1)}},E=async c=>{const _=window.prompt("Valor pago (ex: 1200.00):");if(!_)return;const $=Number(_);if(Number.isNaN($)||$<=0)return;const F=window.prompt("Data do pagamento (YYYY-MM-DD):",new Date().toISOString().slice(0,10));if(F){v(!0);try{const L=await P.receivables.recordPayment(c,$,F);f(A=>A.map(T=>T.id===c?L:T)),await p()}catch(L){N(L?.message||"Erro ao registrar pagamento")}finally{v(!1)}}},M=n?.buckets;return e.jsxs(U,{className:"p-4 border border-slate-200/70 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase text-slate-400 font-semibold tracking-widest",children:"Recebíveis"}),e.jsx("h4",{className:"text-lg font-bold text-slate-800",children:"Contas a Receber"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"month",value:S,onChange:c=>o(c.target.value),className:"rounded-lg border border-slate-200 px-3 py-2 text-sm"}),e.jsxs("button",{onClick:b,className:"px-4 py-2 rounded-lg bg-blue-600 text-white text-sm font-semibold shadow-sm hover:bg-blue-700 disabled:opacity-60 inline-flex items-center gap-2",disabled:a||!h,title:h?void 0:"Acesso restrito a finanças",children:[a&&e.jsx(B,{className:"h-4 w-4 animate-spin"}),"Gerar Cobranças do Mês"]})]})]}),k&&e.jsx("p",{className:"text-sm text-red-600",children:k}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsx(G,{label:"0-30 dias",value:M?.d0_30.total||0,color:"border-emerald-100"}),e.jsx(G,{label:"31-60 dias",value:M?.d31_60.total||0,color:"border-amber-100"}),e.jsx(G,{label:"61-90 dias",value:M?.d61_90.total||0,color:"border-orange-100"}),e.jsx(G,{label:"> 90 dias",value:M?.d90_plus.total||0,color:"border-red-100"})]}),j&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[e.jsx(B,{className:"h-4 w-4 animate-spin text-blue-600"}),"Carregando cobranças..."]}),!j&&m.length===0&&e.jsx("p",{className:"text-sm text-slate-500",children:"Nenhuma cobrança encontrada."}),e.jsx("div",{className:"space-y-2",children:m.map(c=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-100 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-blue-50 text-blue-700 flex items-center justify-center",children:e.jsx(je,{size:18})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-800",children:c.unitId}),e.jsx(z,{variant:c.status==="paid"?"success":c.status==="partial"?"warn":"neutral",children:c.status})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Vencimento: ",c.dueDate," • Valor: ",W(c.amount)," • Pago:"," ",W(c.amountPaid||0)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{variant:"neutral",className:"text-[10px]",children:c.period}),h&&e.jsxs("button",{onClick:()=>E(c.id),className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border border-blue-200 text-blue-700 text-sm font-semibold hover:bg-blue-50 disabled:opacity-60",disabled:a,children:[e.jsx(ve,{size:14}),"Baixar"]})]})]},c.id))})]})}const H=t=>t==null?"R$ 0,00":t.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});function xt(){const[t,l]=s.useState(null),[m,f]=s.useState([]),[n,x]=s.useState([]),[j,i]=s.useState([]),[u,y]=s.useState(!0),[k,N]=s.useState(null),[S,o]=s.useState(""),[a,v]=s.useState({avulsas:!0}),[h,I]=s.useState(null),[g,p]=s.useState(!1),[b,E]=s.useState({}),[M,c]=s.useState(!1),[_,$]=s.useState(!1),[F,L]=s.useState(!1),A=s.useCallback(async()=>{y(!0),N(null);try{const[r,d,C]=await Promise.all([Ue(30),ne(),Be()]);l(r),f(d),x(C)}catch(r){console.error("[RealEstateDashboard] Erro:",r),N("Falha ao carregar dados do portfólio.")}finally{y(!1)}},[]),T=s.useCallback(async r=>{if(!r){i([]);return}const d=await qe(r);i(d);const C=d[0];E(C?{unitId:C.unitId,tenantName:C.tenantName,startDate:C.startDate,endDate:C.endDate,rentAmount:C.rentAmount,readjustmentIndex:C.readjustmentIndex}:{unitId:r,tenantName:"",startDate:"",endDate:"",rentAmount:0,readjustmentIndex:"IGPM"})},[]);s.useEffect(()=>{A()},[A]),s.useEffect(()=>{h&&T(h.id)},[h,T]);const te=r=>{v(d=>({...d,[r]:!d[r]}))},ce=s.useMemo(()=>{const r=S.toLowerCase();return(m||[]).filter(d=>d.name.toLowerCase().includes(r))},[m,S]),O=s.useMemo(()=>{const r={};return(n||[]).forEach(d=>{const C=d.buildingId||"avulsas";r[C]||(r[C]=[]),r[C].push(d)}),r},[n]),D=s.useMemo(()=>j[0]||null,[j]),xe=s.useMemo(()=>{if(!D?.endDate)return!1;const d=new Date(D.endDate).getTime()-Date.now();return d>0&&d<720*60*60*1e3},[D]),me=async()=>{if(!b.unitId||!b.tenantName||!b.startDate||!b.endDate||!b.rentAmount){alert("Preencha os dados do contrato.");return}p(!0);try{D?await Fe(D.id,{tenantName:b.tenantName,startDate:b.startDate,endDate:b.endDate,rentAmount:b.rentAmount,readjustmentIndex:b.readjustmentIndex}):await _e({unitId:b.unitId,tenantName:b.tenantName,startDate:b.startDate,endDate:b.endDate,rentAmount:b.rentAmount,readjustmentIndex:b.readjustmentIndex}),await T(b.unitId)}finally{p(!1)}};return e.jsxs("div",{className:"pt-24 space-y-8 pb-24 fade-in",children:[e.jsx(ye,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{size:24,className:"text-primary"}),e.jsx("span",{className:"tracking-tight font-display",children:"Portfólio Imobiliário"})]}),subtitle:"Gestão centralizada por edifícios e propriedades individuais.",actions:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:A,className:"bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 border border-slate-200 dark:border-slate-700 px-3 py-2 rounded-xl text-sm font-bold transition-all shadow-sm flex items-center gap-2 active:scale-95",title:"Atualizar",children:e.jsx(se,{size:14,className:X(u&&"animate-spin")})}),e.jsxs("button",{onClick:()=>$(!0),className:"bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 border border-slate-200 dark:border-slate-700 px-4 py-2 rounded-xl text-sm font-bold transition-all shadow-sm flex items-center gap-2 active:scale-95 font-display",children:[e.jsx(K,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Proprietário"})]}),e.jsxs("button",{onClick:()=>L(!0),className:"bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 border border-slate-200 dark:border-slate-700 px-4 py-2 rounded-xl text-sm font-bold transition-all shadow-sm flex items-center gap-2 active:scale-95 font-display",children:[e.jsx(q,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Edifício"})]}),e.jsxs("button",{onClick:()=>c(!0),className:"bg-primary hover:bg-primary/90 text-white px-4 py-2 rounded-xl text-sm font-bold transition-all shadow-glow flex items-center gap-2 active:scale-95 font-display",children:[e.jsx(Y,{size:16}),"Imóvel"]})]})}),M&&e.jsx(Oe,{onClose:()=>c(!1),onSuccess:A}),_&&e.jsx(ie,{onClose:()=>$(!1),onSuccess:A}),F&&e.jsx(oe,{onClose:()=>L(!1),onSuccess:A}),e.jsx(Ne,{isLoading:u,error:k,isEmpty:!1,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(V,{label:"Receita Bruta (30d)",value:H(t?.totals?.grossRevenue),icon:he,variant:"default"}),e.jsx(V,{label:"Unidades Ativas",value:t?.totals?.activeUnits?.toString()||"0",icon:J,variant:"default"}),e.jsx(V,{label:"Lucro Operacional",value:H(t?.totals?.netRevenue),icon:ae,variant:"success"}),e.jsx(V,{label:"Booking Volume",value:t?.totals?.staysCount?.toString()||"0",icon:Ie,variant:"default"})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:["Edifícios & Ativos",e.jsx(z,{variant:"neutral",children:m.length})]}),e.jsxs("div",{className:"relative w-full md:w-80",children:[e.jsx(we,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Buscar edifício...",value:S,onChange:r=>o(r.target.value),className:"w-full bg-white border border-slate-200 rounded-xl pl-10 pr-4 py-2 text-sm focus:ring-2 focus:ring-blue-500/20 transition-all outline-none"})]})]}),e.jsxs("div",{className:"space-y-4",children:[ce.map(r=>e.jsxs("div",{className:"group",children:[e.jsxs("button",{onClick:()=>te(r.id),className:"w-full flex items-center justify-between p-4 bg-white border border-slate-200 rounded-2xl hover:border-blue-300 transition-all shadow-sm group-hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600",children:e.jsx(q,{size:24})}),e.jsxs("div",{className:"text-left leading-tight",children:[e.jsx("h4",{className:"font-bold text-slate-900",children:r.name}),e.jsx("p",{className:"text-xs text-slate-500",children:r.address||"Sem endereço cadastrado"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"hidden md:block text-right",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-widest",children:"Unidades"}),e.jsx("p",{className:"font-bold text-slate-700",children:O[r.id]?.length||0})]}),a[r.id]?e.jsx(le,{className:"text-slate-400"}):e.jsx(Q,{className:"text-slate-400"})]})]}),a[r.id]&&e.jsx("div",{className:"mt-2 ml-6 pl-6 border-l-2 border-slate-100 space-y-2 animate-in slide-in-from-top-2 duration-300",children:O[r.id]?.map(d=>e.jsxs("div",{className:X("flex items-center justify-between p-3 bg-slate-50/50 rounded-xl border border-slate-100/50 hover:bg-slate-50 transition-colors",h?.id===d.id&&"ring-2 ring-blue-200"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{variant:d.active?"success":"neutral",children:d.code}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:d.name||"Sem nome"})]}),e.jsx("button",{className:"text-xs font-bold text-blue-600 hover:text-blue-700",onClick:()=>{I(d),E(C=>({...C,unitId:d.id}))},children:"DETALHES"})]},d.id))||e.jsx("p",{className:"text-xs text-slate-400 italic",children:"Nenhuma unidade vinculada."})})]},r.id)),e.jsxs("div",{className:"group",children:[e.jsxs("button",{onClick:()=>te("avulsas"),className:"w-full flex items-center justify-between p-4 bg-slate-50 border border-dashed border-slate-300 rounded-2xl hover:border-slate-400 transition-all shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-slate-200 flex items-center justify-center text-slate-500",children:e.jsx(J,{size:24})}),e.jsxs("div",{className:"text-left leading-tight",children:[e.jsx("h4",{className:"font-bold text-slate-700 tracking-tight",children:"Propriedades Avulsas"}),e.jsx("p",{className:"text-xs text-slate-500 italic",children:"Unidades sem edifício vinculado"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"hidden md:block text-right",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-widest",children:"Contagem"}),e.jsx("p",{className:"font-bold text-slate-600",children:O.avulsas?.length||0})]}),a.avulsas?e.jsx(le,{className:"text-slate-400"}):e.jsx(Q,{className:"text-slate-400"})]})]}),a.avulsas&&e.jsx("div",{className:"mt-2 ml-6 pl-6 border-l-2 border-slate-100 space-y-2 animate-in slide-in-from-top-2 duration-300",children:O.avulsas?.map(r=>e.jsxs("div",{className:X("flex items-center justify-between p-3 bg-white rounded-xl border border-slate-100 hover:shadow-sm transition-all",h?.id===r.id&&"ring-2 ring-blue-200"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{variant:r.active?"success":"neutral",children:r.code}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:r.name||"Sem nome"})]}),e.jsx("button",{className:"text-xs font-bold text-blue-600 hover:text-blue-700",onClick:()=>{I(r),E(d=>({...d,unitId:r.id}))},children:"DETALHES"})]},r.id))})]})]})]}),h&&e.jsxs(e.Fragment,{children:[e.jsxs(U,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(J,{size:18,className:"text-primary"}),h.name||h.code]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Contrato ativo e status do inquilino."})]}),e.jsx(z,{variant:h.active?"success":"neutral",children:h.active?"Ativa":"Inativa"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs(U,{className:"p-4 border border-slate-200/70",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-bold text-slate-800",children:"Contrato Ativo"}),xe&&e.jsx(z,{variant:"warn",children:"Vencendo em breve"})]}),D?e.jsxs("div",{className:"space-y-2 text-sm text-slate-700",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Inquilino:"})," ",D.tenantName]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Período:"})," ",D.startDate," → ",D.endDate]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Aluguel:"})," ",H(D.rentAmount)]}),D.readjustmentIndex&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Índice:"})," ",D.readjustmentIndex]})]}):e.jsx("p",{className:"text-sm text-slate-500",children:"Nenhum contrato cadastrado para esta unidade."})]}),e.jsxs(U,{className:"p-4 border border-slate-200/70",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-bold text-slate-800",children:D?"Renovar Contrato":"Criar Contrato"}),g&&e.jsx(se,{size:16,className:"animate-spin text-slate-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("label",{className:"text-xs text-slate-500 font-semibold",children:["Inquilino",e.jsx("input",{type:"text",value:b.tenantName||"",onChange:r=>E(d=>({...d,tenantName:r.target.value})),className:"w-full mt-1 rounded-lg border border-slate-200 px-3 py-2 text-sm"})]}),e.jsxs("label",{className:"text-xs text-slate-500 font-semibold",children:["Aluguel",e.jsx("input",{type:"number",value:b.rentAmount??"",onChange:r=>E(d=>({...d,rentAmount:Number(r.target.value)})),className:"w-full mt-1 rounded-lg border border-slate-200 px-3 py-2 text-sm"})]}),e.jsxs("label",{className:"text-xs text-slate-500 font-semibold",children:["Início",e.jsx("input",{type:"date",value:b.startDate||"",onChange:r=>E(d=>({...d,startDate:r.target.value})),className:"w-full mt-1 rounded-lg border border-slate-200 px-3 py-2 text-sm"})]}),e.jsxs("label",{className:"text-xs text-slate-500 font-semibold",children:["Fim",e.jsx("input",{type:"date",value:b.endDate||"",onChange:r=>E(d=>({...d,endDate:r.target.value})),className:"w-full mt-1 rounded-lg border border-slate-200 px-3 py-2 text-sm"})]}),e.jsxs("label",{className:"text-xs text-slate-500 font-semibold",children:["Índice de Reajuste",e.jsxs("select",{value:b.readjustmentIndex||"IGPM",onChange:r=>E(d=>({...d,readjustmentIndex:r.target.value})),className:"w-full mt-1 rounded-lg border border-slate-200 px-3 py-2 text-sm",children:[e.jsx("option",{value:"IGPM",children:"IGPM"}),e.jsx("option",{value:"IPCA",children:"IPCA"})]})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{onClick:me,disabled:g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-bold shadow-sm hover:bg-blue-700 disabled:opacity-60",children:D?"Renovar Contrato":"Criar Contrato"})})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(He,{entityId:h.id,entityType:"unit"})}),e.jsx("div",{className:"mt-4",children:e.jsx(Je,{ownerId:h.ownerId})}),e.jsx("div",{className:"mt-4",children:e.jsx(Ke,{unitId:h.id,ownerId:h.ownerId})})]}),t?.potentialCharges&&e.jsx(U,{className:"p-6 border-slate-200 shadow-xl shadow-slate-200/40",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{className:"space-y-1 text-center md:text-left",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 tracking-tight flex items-center gap-2 justify-center md:justify-start",children:[e.jsx(ae,{className:"text-emerald-500",size:20}),"Billing Preview"]}),e.jsxs("p",{className:"text-sm text-slate-500 max-w-lg",children:["Estimativa mensal baseada na volumetria atual do seu portfólio (",t.totals.activeOwners," proprietários e ",t.totals.activeUnits," unidades)."]})]}),e.jsxs("div",{className:"flex items-center gap-8 bg-white p-3 rounded-2xl border border-slate-100 shadow-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-widest",children:"Base Mensal"}),e.jsx("p",{className:"text-xl font-black text-slate-900 tracking-tighter",children:H(t.potentialCharges.total)})]}),e.jsx(Q,{size:20,className:"text-slate-200"}),e.jsx("button",{className:"px-5 py-2.5 bg-blue-600 text-white rounded-xl font-bold text-sm shadow-lg shadow-blue-500/20 hover:bg-blue-700 active:scale-95 transition-all",children:"Upgrade Pro"})]})]})})]})}export{xt as default};
