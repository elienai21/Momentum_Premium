import{a as o,j as e}from"./charts--kFkiaCp.js";import{s as S,G as C,v as h,S as k,E as g,I as A,f as z}from"./index-CETmOTzF.js";import{S as L}from"./SectionHeader-DkKv0CWh.js";import{ac as T,k as B,F as D,n as f,ad as M,u as E,B as F}from"./icons-Bc7DOyy3.js";import"./vendor-DnLjH3oN.js";import"./query-BGhlxTj0.js";import"./firebase-dP-Dck55.js";function q(){const{data:l=[],isLoading:v,error:j,markAsRead:c}=S(),[a,d]=o.useState(""),[n,u]=o.useState("all"),[r,x]=o.useState("all"),[m,b]=o.useState("date"),p=o.useMemo(()=>l.filter(t=>{const s=t.title.toLowerCase().includes(a.toLowerCase())||t.message.toLowerCase().includes(a.toLowerCase()),i=n==="all"||t.severity===n,y=r==="all"||t.status===r;return s&&i&&y}).sort((t,s)=>{if(m==="date")return new Date(s.createdAt).getTime()-new Date(t.createdAt).getTime();{const i={high:3,medium:2,low:1};return i[s.severity]-i[t.severity]}}),[l,a,n,r,m]),N=async()=>{const t=l.filter(s=>s.status==="unread").map(s=>s.id);for(const s of t)await c(s)},w=t=>{switch(t){case"high":return"danger";case"medium":return"warn";default:return"info"}};return e.jsxs("div",{className:"space-y-8 pb-20 fade-in","aria-live":"polite",children:[e.jsx(L,{title:"Centro de Alertas",subtitle:"Monitore anomalias, vencimentos e mudanças importantes na sua saúde financeira.",actions:e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:N,className:"px-4 py-2 bg-momentum-bg/50 border border-momentum-border rounded-lg text-xs font-medium text-momentum-text hover:bg-momentum-bg transition-all flex items-center gap-2",children:[e.jsx(T,{size:14})," Marcar todos como lidos"]})})}),e.jsxs(C,{className:"p-4 flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative w-full md:w-96",children:[e.jsx(B,{className:"absolute left-3 top-2.5 text-momentum-muted",size:16}),e.jsx("input",{type:"text",placeholder:"Buscar alertas...",value:a,onChange:t=>d(t.target.value),className:"w-full bg-momentum-bg/50 border border-momentum-border rounded-lg pl-10 pr-4 py-2 text-sm focus:ring-2 focus:ring-momentum-accent outline-none transition-all text-momentum-text placeholder:text-momentum-muted/70"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 w-full md:w-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-momentum-bg/30 p-1 rounded-lg border border-momentum-border",children:[e.jsx(D,{size:14,className:"ml-2 text-momentum-muted"}),e.jsxs("select",{value:n,onChange:t=>u(t.target.value),className:"bg-transparent text-xs text-momentum-text outline-none pr-2",children:[e.jsx("option",{value:"all",children:"Severidade: Todas"}),e.jsx("option",{value:"high",children:"Alta"}),e.jsx("option",{value:"medium",children:"Média"}),e.jsx("option",{value:"low",children:"Baixa"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-momentum-bg/30 p-1 rounded-lg border border-momentum-border",children:[e.jsx(f,{size:14,className:"ml-2 text-momentum-muted"}),e.jsxs("select",{value:r,onChange:t=>x(t.target.value),className:"bg-transparent text-xs text-momentum-text outline-none pr-2",children:[e.jsx("option",{value:"all",children:"Status: Todos"}),e.jsx("option",{value:"unread",children:"Não lidos"}),e.jsx("option",{value:"read",children:"Lidos"})]})]}),e.jsxs("button",{onClick:()=>b(t=>t==="date"?"severity":"date"),className:"p-2 bg-momentum-bg/50 border border-momentum-border rounded-lg text-momentum-muted hover:text-momentum-accent transition-all flex items-center gap-2",title:"Alternar ordenação",children:[e.jsx(M,{size:14}),e.jsx("span",{className:"text-xs font-medium uppercase font-display",children:m==="date"?"Data":"Nível"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:v?e.jsx(h,{children:[1,2,3,4].map(t=>e.jsx(k,{className:"h-24"},t))}):j?e.jsx(g,{icon:e.jsx(E,{size:48,className:"text-momentum-danger"}),title:"Erro ao carregar alertas",description:"Não conseguimos sincronizar com o servidor de notificações.",action:e.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-momentum-accent text-white rounded-lg font-medium",children:"Tentar novamente"})}):p.length===0?e.jsx(g,{icon:e.jsx(F,{size:48,className:"text-momentum-muted"}),title:"Sem alertas no momento",description:a||n!=="all"||r!=="all"?"Nenhum alerta corresponde aos seus filtros atuais.":"Você está em dia! Nenhuma anomalia financeira detectada.",action:a||n!=="all"||r!=="all"?e.jsx("button",{onClick:()=>{d(""),u("all"),x("all")},className:"text-momentum-accent hover:underline text-sm font-medium",children:"Limpar filtros"}):void 0}):e.jsx(h,{children:p.map(t=>e.jsx(A,{title:t.title,description:t.message,severity:w(t.severity),className:z(t.status==="read"&&"opacity-60 saturate-50 hover:opacity-100 hover:saturate-100"),actions:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("span",{className:"text-[10px] text-momentum-muted flex items-center gap-1",children:[e.jsx(f,{size:10}),new Date(t.createdAt).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})]}),t.status==="unread"&&e.jsx("button",{onClick:()=>c(t.id),className:"text-[10px] font-bold text-momentum-accent hover:underline uppercase tracking-tighter",children:"Marcar como lido"})]})},t.id))})})]})}export{q as default};
