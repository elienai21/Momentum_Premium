import{c as y,r as n,j as e,a as S,G as j}from"./index-yBjCuyq5.js";import{C as N,B as M,b as A,c as D,f as I,g as R,p as _,d as T}from"./chart-BJ99D5hM.js";import{A as z}from"./AsyncPanel-OzLCl5j3.js";import{g as O}from"./adminApi-RyZ3GEiO.js";import{I as P}from"./InviteMemberModal-BmgY2xLE.js";import{A as $}from"./AdvisorDock-W9T3F8s7.js";import{P as F}from"./plus-B0lAGzQi.js";import{D as U}from"./dollar-sign-DqnybV3j.js";import{A as B}from"./activity-DJKk-x2U.js";import{U as L}from"./users-DW6yZrXV.js";import"./rotate-ccw-DU9Bc9uM.js";import"./user-B28uMnpN.js";import"./AdvisorChat-BJEFtGTd.js";import"./SectionHeader-MSrAe8iw.js";import"./trash-2-B738TgPz.js";import"./send-BjKxuDE5.js";const V=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],q=y("chart-column",V);const G=[["path",{d:"M16 10a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 14.286V4a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z",key:"1n2ejm"}],["path",{d:"M20 9a2 2 0 0 1 2 2v10.286a.71.71 0 0 1-1.212.502l-2.202-2.202A2 2 0 0 0 17.172 19H10a2 2 0 0 1-2-2v-1",key:"1qfcsi"}]],H=y("messages-square",G);const K=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],W=y("shield-alert",K),k="label";function C(t,s){typeof t=="function"?t(s):t&&(t.current=s)}function J(t,s){const r=t.options;r&&s&&Object.assign(r,s)}function w(t,s){t.labels=s}function E(t,s,r=k){const i=[];t.datasets=s.map(l=>{const c=t.datasets.find(p=>p[r]===l[r]);return!c||!l.data||i.includes(c)?{...l}:(i.push(c),Object.assign(c,l),c)})}function Q(t,s=k){const r={labels:[],datasets:[]};return w(r,t.labels),E(r,t.datasets,s),r}function X(t,s){const{height:r=150,width:i=300,redraw:l=!1,datasetIdKey:c,type:p,data:d,options:m,plugins:g=[],fallbackContent:f,updateMode:h,...v}=t,u=n.useRef(null),o=n.useRef(null),a=()=>{u.current&&(o.current=new N(u.current,{type:p,data:Q(d,c),options:m&&{...m},plugins:g}),C(s,o.current))},x=()=>{C(s,null),o.current&&(o.current.destroy(),o.current=null)};return n.useEffect(()=>{!l&&o.current&&m&&J(o.current,m)},[l,m]),n.useEffect(()=>{!l&&o.current&&w(o.current.config.data,d.labels)},[l,d.labels]),n.useEffect(()=>{!l&&o.current&&d.datasets&&E(o.current.config.data,d.datasets,c)},[l,d.datasets]),n.useEffect(()=>{o.current&&(l?(x(),setTimeout(a)):o.current.update(h))},[l,m,d.labels,d.datasets,h]),n.useEffect(()=>{o.current&&(x(),setTimeout(a))},[p]),n.useEffect(()=>(a(),()=>x()),[]),e.jsx("canvas",{ref:u,role:"img",height:r,width:i,...v,children:f})}const Y=n.forwardRef(X);function Z(t,s){return N.register(s),n.forwardRef((r,i)=>e.jsx(Y,{...r,ref:i,type:t}))}const ee=Z("bar",M);N.register(A,D,I,R,_,T);function be(){const[t,s]=n.useState(null),[r,i]=n.useState(!0),{notify:l}=S(),[c,p]=n.useState(!1),[d,m]=n.useState(!1);n.useEffect(()=>{g()},[]);const g=async()=>{try{i(!0);const a=await O();s(a)}catch(a){console.error(a),l({type:"error",message:"Erro ao carregar dados do admin."})}finally{i(!1)}},f=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:4}).format(a),h={labels:Object.keys(t?.dailyCost||{}).sort().slice(-14),datasets:[{label:"Custo Diário de IA ($)",data:Object.keys(t?.dailyCost||{}).sort().slice(-14).map(a=>t?.dailyCost[a]),backgroundColor:"rgba(124, 58, 237, 0.5)",borderColor:"rgba(124, 58, 237, 1)",borderWidth:1}]},v={responsive:!0,plugins:{legend:{position:"top",labels:{color:"#94a3b8"}},title:{display:!1}},scales:{y:{ticks:{color:"#94a3b8"},grid:{color:"rgba(255, 255, 255, 0.05)"}},x:{ticks:{color:"#94a3b8"},grid:{display:!1}}}},u=(t?.activeTenantsCount||0)*49,o=u>0?(u-(t?.totalEstimatedCost||0))/u*100:0;return e.jsxs("div",{className:"pt-24 pb-24 space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(W,{size:20,className:"text-violet-500"}),e.jsx("span",{className:"text-xs font-bold text-violet-500 uppercase tracking-widest font-display",children:"Admin Power Pack"})]}),e.jsx("h1",{className:"text-3xl font-bold text-slate-100 font-display",children:"Unit Economics"}),e.jsx("p",{className:"text-slate-400 font-display",children:"Monitoramento de custos de IA e saúde financeira."})]}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("button",{type:"button",onClick:()=>p(!0),className:"inline-flex items-center gap-2 px-3 py-2 rounded-xl bg-violet-600 text-white text-xs font-semibold shadow-glow hover:bg-violet-500 transition",children:[e.jsx(F,{size:14})," Criar Empresa"]}),e.jsxs("button",{type:"button",onClick:()=>m(!0),className:"inline-flex items-center gap-2 px-3 py-2 rounded-xl border border-slate-700 bg-slate-900 text-slate-200 text-xs font-semibold hover:bg-slate-800 transition",children:[e.jsx(H,{size:14})," Falar com Advisor"]}),e.jsx("div",{className:"px-3 py-1 bg-slate-800 rounded-full border border-slate-700 text-xs text-slate-400 font-mono hidden md:block",children:"v1.0.0"})]})]}),e.jsxs(z,{isLoading:r,error:null,isEmpty:!1,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(b,{label:"Custo Total IA (30d)",value:f(t?.totalEstimatedCost||0),icon:U,trend:"needs_attn"}),e.jsx(b,{label:"Receita Est. (MRR)",value:`$${u.toFixed(2)}`,icon:B,trend:"neutral"}),e.jsx(b,{label:"Margem Bruta Est.",value:`${o.toFixed(1)}%`,icon:q,trend:o>70?"positive":"negative"}),e.jsx(b,{label:"Tokens Processados",value:new Intl.NumberFormat("en-US",{notation:"compact"}).format(t?.totalTokens||0),icon:L,trend:"neutral"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(j,{className:"p-6 h-full border-slate-800 bg-slate-950/50",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-200 mb-6 font-display",children:"Tendência de Custo Diário"}),e.jsx("div",{className:"h-[300px] w-full",children:t&&e.jsx(ee,{data:h,options:v})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(j,{className:"p-0 h-full border-slate-800 bg-slate-950/50 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-800/50 bg-slate-900/50 flex justify-between items-center",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-200 font-display uppercase tracking-wider",children:"Top Spenders"}),e.jsx("span",{className:"text-[10px] text-slate-500",children:"Últimos 30 dias"})]}),e.jsx("div",{className:"overflow-y-auto max-h-[350px]",children:e.jsx("table",{className:"w-full text-left text-xs",children:e.jsxs("tbody",{className:"divide-y divide-slate-800/50",children:[t?.topSpenders.map((a,x)=>e.jsxs("tr",{className:"hover:bg-slate-800/30 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"font-mono text-slate-500 text-[10px]",children:["#",x+1]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-slate-200",children:a.name}),e.jsxs("div",{className:"text-[10px] text-slate-500",children:[a.plan," • ",a.tenantId.substring(0,6),"..."]})]})]})}),e.jsxs("td",{className:"p-4 text-right",children:[e.jsx("div",{className:"font-mono font-bold text-violet-400",children:f(a.cost)}),e.jsxs("div",{className:"text-[10px] text-slate-500",children:[(a.tokens/1e3).toFixed(1),"k toks"]})]})]},a.tenantId)),(!t?.topSpenders||t.topSpenders.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"p-8 text-center text-slate-500",children:"Sem dados"})})]})})})]})})]})]}),c&&e.jsx(P,{onClose:()=>p(!1),onSuccess:()=>p(!1)}),e.jsx($,{open:d,onClose:()=>m(!1)})]})}function b({label:t,value:s,icon:r,trend:i}){const l={positive:"text-emerald-500",negative:"text-rose-500",neutral:"text-slate-400",needs_attn:"text-amber-500"};return e.jsxs(j,{className:"p-5 border-slate-800 bg-slate-950/50 flex flex-col justify-between h-32 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-violet-500/5 rounded-full blur-2xl -mr-8 -mt-8 pointer-events-none group-hover:bg-violet-500/10 transition-colors"}),e.jsxs("div",{className:"flex justify-between items-start relative z-10",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest font-display",children:t}),e.jsx(r,{size:16,className:"text-slate-600"})]}),e.jsx("div",{className:`text-2xl font-black font-display tracking-tight relative z-10 ${l[i]||"text-slate-200"}`,children:s})]})}export{be as default};
