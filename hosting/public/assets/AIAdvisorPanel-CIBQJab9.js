import{f as N,r as c,h as k,u as T,i as S,l as A,j as e,L as m,g as o,a as z}from"./index-C63jyLGJ.js";import{S as P}from"./sparkles-C96Sqrad.js";import{B as I,U as E,S as M}from"./user-DOyB9LsW.js";async function C(i){return(await z.post("/advisor/session",{messages:[{role:"user",content:i}]})).data}const V=()=>{const{user:i,loading:d}=N(),[p,l]=c.useState([{role:"assistant",text:"Olá! Sou seu consultor financeiro Momentum. Como posso ajudar com sua análise hoje?"}]),[a,u]=c.useState(!1),r=c.useRef(null),{features:h,voiceProfiles:b}=k(),g=T(),{speak:v}=S(),x=h??{voiceTier:"none",voiceTTS:!1,voiceSTT:!1},j=b??[],w=A(x.voiceTier,j,"advisor");if(d)return e.jsxs("div",{className:"p-8 flex flex-col items-center justify-center gap-4 text-momentum-muted italic",children:[e.jsx(m,{className:"animate-spin",size:20}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"Conectando Advisor..."})]});if(!i||!g)return null;async function f(){const s=(r.current?.value||"").trim();if(!(!s||a)){r.current&&(r.current.value=""),l(t=>[...t,{role:"user",text:s},{role:"assistant",text:"Processando análise estratégica..."}]),u(!0);try{const n=(await C(s)).reply?.answer||"Sem resposta no momento. Tente reformular sua pergunta.";l(y=>y.slice(0,-1).concat({role:"assistant",text:n})),x.voiceTTS&&await v({text:n,voice:w,profile:"aconselhamento"})}catch(t){console.error("Advisor Error:",t),l(n=>n.slice(0,-1).concat({role:"assistant",text:"Erro ao processar resposta. Tente novamente."}))}finally{u(!1)}}}return e.jsxs("div",{className:"flex flex-col h-full bg-transparent",children:[e.jsxs("header",{className:"p-6 border-b border-momentum-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-momentum-accent/10 text-momentum-accent",children:e.jsx(P,{size:16})}),e.jsx("h3",{className:"text-sm font-bold text-momentum-text uppercase tracking-widest leading-none",children:"AI Advisor"})]}),e.jsx("p",{className:"text-[10px] text-momentum-muted font-medium uppercase tracking-wider leading-relaxed",children:"Inteligência Financeira Momentum em Tempo Real"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4 scroll-smooth scrollbar-none",children:[p.map((s,t)=>e.jsx("div",{className:o("flex w-full animate-in fade-in slide-in-from-bottom-2 duration-300",s.role==="user"?"justify-end":"justify-start"),children:e.jsxs("div",{className:o("flex gap-3 max-w-[90%]",s.role==="user"?"flex-row-reverse":"flex-row"),children:[e.jsx("div",{className:o("h-6 w-6 rounded-full flex items-center justify-center shrink-0 mt-1 shadow-sm",s.role==="assistant"?"bg-momentum-accent text-white":"bg-white border border-momentum-border text-momentum-text"),children:s.role==="assistant"?e.jsx(I,{size:12}):e.jsx(E,{size:12})}),e.jsx("div",{className:o("px-3 py-2.5 rounded-2xl text-[13px] leading-relaxed shadow-sm",s.role==="assistant"?"bg-slate-50 dark:bg-slate-900/50 text-momentum-text rounded-tl-none border border-momentum-border/30":"bg-momentum-accent text-white rounded-tr-none shadow-momentum-glow"),children:e.jsx("div",{dangerouslySetInnerHTML:{__html:s.text.replace(/\//g,"<br/>")}})})]})},t)),a&&e.jsx("div",{className:"flex justify-start animate-pulse",children:e.jsxs("div",{className:"flex gap-2 items-center text-[10px] font-bold text-momentum-accent uppercase tracking-widest pl-10",children:[e.jsx(m,{className:"animate-spin",size:12}),"Analisando histórico..."]})})]}),e.jsxs("div",{className:"p-6 border-t border-momentum-border/50 bg-white/30 backdrop-blur-sm",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("textarea",{ref:r,placeholder:"Pergunte sobre tendências...",className:"w-full bg-white dark:bg-slate-900/50 border border-slate-300 dark:border-white/10 rounded-xl px-4 py-3 pr-12 text-sm text-momentum-text placeholder:text-momentum-muted focus:outline-none focus:ring-2 focus:ring-momentum-accent/20 focus:border-momentum-accent transition-all resize-none min-h-[48px] max-h-32 shadow-inner",onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),f())}}),e.jsx("button",{onClick:f,disabled:a,className:"absolute right-2 bottom-2 h-8 w-8 rounded-lg flex items-center justify-center bg-momentum-accent text-white shadow-momentum-glow hover:scale-105 active:scale-95 transition-all disabled:opacity-50 disabled:scale-100",children:a?e.jsx(m,{size:16,className:"animate-spin"}):e.jsx(M,{size:16})})]}),e.jsx("p",{className:"text-[9px] text-momentum-muted text-center mt-3 uppercase font-bold tracking-tighter opacity-60",children:"Powered by Momentum Intelligence Layer"})]})]})};export{V as A};
