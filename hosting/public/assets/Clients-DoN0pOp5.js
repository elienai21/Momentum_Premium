import{a as l,j as e}from"./charts--kFkiaCp.js";import{h as w,q as C,m as S}from"./firebase-dP-Dck55.js";import{d as D,G as p,B as h,g as A}from"./index-CETmOTzF.js";import{S as z}from"./SectionHeader-DkKv0CWh.js";import{S as c}from"./StatsCard-B55lZtJ5.js";import{U as g,i as j,j as E,k as L,l as U}from"./icons-Bc7DOyy3.js";import"./vendor-DnLjH3oN.js";import"./query-BGhlxTj0.js";const X=()=>{const{tenantId:r}=D(),[s,d]=l.useState([]),[u,m]=l.useState(!0),[i,f]=l.useState("");l.useEffect(()=>{if(!r){d([]),m(!1);return}async function t(){m(!0);try{const a=w(A,"tenants",r,"clients"),n=C(a),y=(await S(n)).docs.map(x=>({id:x.id,...x.data()}));d(y)}catch(a){console.error("Error loading clients",a)}finally{m(!1)}}t()},[r]);const v=s.length;s.filter(t=>t.status==="active").length;const N=s.filter(t=>t.status==="inactive").length,b=s.filter(t=>{if(!t.createdAt)return!1;const a=t.createdAt.toDate?t.createdAt.toDate():new Date(t.createdAt),n=new Date;return n.setDate(n.getDate()-30),a>n}).length,o=s.filter(t=>t.name.toLowerCase().includes(i.toLowerCase())||t.email.toLowerCase().includes(i.toLowerCase()));return e.jsxs("div",{className:"space-y-8 pb-20 fade-in","aria-live":"polite",children:[e.jsx(z,{title:"Clientes",subtitle:"Gerencie sua base de clientes e acompanhe métricas de engajamento.",actions:e.jsxs("button",{className:"bg-momentum-accent hover:bg-momentum-accent/90 text-white px-4 py-2 rounded-lg text-sm font-medium transition-all shadow-momentum-glow flex items-center gap-2",children:[e.jsx(g,{size:16})," ",e.jsx("span",{className:"hidden sm:inline",children:"Novo Cliente"})]})}),r?u?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[1,2,3].map(t=>e.jsx(p,{className:"h-32 animate-pulse bg-current/5",children:e.jsx("div",{})},t))}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(c,{label:"Total de Clientes",value:String(v),icon:j,variant:"default"}),e.jsx(c,{label:"Novos (30 dias)",value:`+${b}`,icon:g,variant:"success"}),e.jsx(c,{label:"Inativos",value:String(N),icon:E,variant:"danger"})]}):e.jsx("div",{className:"p-12 text-center text-momentum-muted",children:"Selecione um tenant para visualizar os clientes."}),e.jsxs(p,{className:"p-0 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-momentum-border flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"relative max-w-sm w-full",children:[e.jsx(L,{className:"absolute left-3 top-2.5 text-momentum-muted",size:16}),e.jsx("input",{type:"text",placeholder:"Buscar cliente...",value:i,onChange:t=>f(t.target.value),className:"w-full bg-momentum-bg/50 border border-momentum-border rounded-lg pl-9 pr-4 py-2 text-sm focus:ring-2 focus:ring-momentum-accent outline-none transition-all text-momentum-text placeholder:text-momentum-muted/70"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(h,{variant:"neutral",children:[o.length," cadastrados"]})})]}),e.jsx("div",{className:"overflow-x-auto",children:u?e.jsxs("div",{className:"p-12 text-center flex flex-col items-center gap-2 text-momentum-muted animate-pulse",children:[e.jsx(j,{size:32,className:"opacity-20"}),e.jsx("p",{children:"Carregando lista de clientes..."})]}):e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-momentum-muted/5 text-momentum-muted font-semibold uppercase text-xs tracking-wider border-b border-momentum-border",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Nome"}),e.jsx("th",{className:"px-6 py-4",children:"Status"}),e.jsx("th",{className:"px-6 py-4",children:"Email"}),e.jsx("th",{className:"px-6 py-4",children:"Data Cadastro"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Ações"})]})}),e.jsxs("tbody",{className:"divide-y divide-momentum-border",children:[o.map(t=>e.jsxs("tr",{className:"hover:bg-momentum-accent/5 transition-colors group",children:[e.jsxs("td",{className:"px-6 py-4 font-medium text-momentum-text flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-momentum-accent/10 flex items-center justify-center text-momentum-accent font-bold text-xs shrink-0",children:(t.name||"?").charAt(0).toUpperCase()}),t.name||"Sem Nome"]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(h,{variant:t.status==="active"?"success":"neutral",className:"capitalize",children:t.status==="active"?"Ativo":t.status})}),e.jsx("td",{className:"px-6 py-4 text-momentum-muted",children:t.email}),e.jsx("td",{className:"px-6 py-4 text-momentum-muted",children:t.createdAt?(t.createdAt.toDate?t.createdAt.toDate():new Date(t.createdAt)).toLocaleDateString("pt-BR"):"-"}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{className:"p-2 hover:bg-momentum-muted/10 rounded-lg text-momentum-muted transition-colors",children:e.jsx(U,{size:16})})})]},t.id)),o.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-12 text-center text-momentum-muted",children:"Nenhum cliente encontrado."})})]})]})})]})]})};export{X as default};
