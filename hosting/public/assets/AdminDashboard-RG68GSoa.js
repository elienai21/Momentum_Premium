import{a,j as e,B as N,C as y,d as C,e as k,h as w,k as S,p as A,f as E}from"./charts--kFkiaCp.js";import{A as D}from"./AsyncPanel-DLrco2Ud.js";import{a as I,l as M,G as x}from"./index-CETmOTzF.js";import{I as F}from"./InviteMemberModal-BjM9Fx5H.js";import{A as O}from"./AdvisorDock-CQQqGDcp.js";import{a1 as P,P as T,a2 as z,Y as U,a3 as _,a4 as $,i as B}from"./icons-Bc7DOyy3.js";import"./vendor-DnLjH3oN.js";import"./query-BGhlxTj0.js";import"./firebase-dP-Dck55.js";import"./AdvisorChat-DJxQEt6s.js";import"./SectionHeader-DkKv0CWh.js";y.register(C,k,w,S,A,E);function X(){const[t,i]=a.useState(null),[n,l]=a.useState(!0),{notify:d}=I(),[h,c]=a.useState(!1),[b,m]=a.useState(!1);a.useEffect(()=>{f()},[]);const f=async()=>{try{l(!0);const s=await M();i(s)}catch(s){console.error(s),d({type:"error",message:"Erro ao carregar dados do admin."})}finally{l(!1)}},p=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:4}).format(s),g={labels:Object.keys(t?.dailyCost||{}).sort().slice(-14),datasets:[{label:"Custo Diário de IA ($)",data:Object.keys(t?.dailyCost||{}).sort().slice(-14).map(s=>t?.dailyCost[s]),backgroundColor:"rgba(124, 58, 237, 0.5)",borderColor:"rgba(124, 58, 237, 1)",borderWidth:1}]},j={responsive:!0,plugins:{legend:{position:"top",labels:{color:"#94a3b8"}},title:{display:!1}},scales:{y:{ticks:{color:"#94a3b8"},grid:{color:"rgba(255, 255, 255, 0.05)"}},x:{ticks:{color:"#94a3b8"},grid:{display:!1}}}},o=(t?.activeTenantsCount||0)*49,u=o>0?(o-(t?.totalEstimatedCost||0))/o*100:0;return e.jsxs("div",{className:"pt-24 pb-24 space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(P,{size:20,className:"text-violet-500"}),e.jsx("span",{className:"text-xs font-bold text-violet-500 uppercase tracking-widest font-display",children:"Admin Power Pack"})]}),e.jsx("h1",{className:"text-3xl font-bold text-slate-100 font-display",children:"Unit Economics"}),e.jsx("p",{className:"text-slate-400 font-display",children:"Monitoramento de custos de IA e saúde financeira."})]}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("button",{type:"button",onClick:()=>c(!0),className:"inline-flex items-center gap-2 px-3 py-2 rounded-xl bg-violet-600 text-white text-xs font-semibold shadow-glow hover:bg-violet-500 transition",children:[e.jsx(T,{size:14})," Criar Empresa"]}),e.jsxs("button",{type:"button",onClick:()=>m(!0),className:"inline-flex items-center gap-2 px-3 py-2 rounded-xl border border-slate-700 bg-slate-900 text-slate-200 text-xs font-semibold hover:bg-slate-800 transition",children:[e.jsx(z,{size:14})," Falar com Advisor"]}),e.jsx("div",{className:"px-3 py-1 bg-slate-800 rounded-full border border-slate-700 text-xs text-slate-400 font-mono hidden md:block",children:"v1.0.0"})]})]}),e.jsxs(D,{isLoading:n,error:null,isEmpty:!1,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(r,{label:"Custo Total IA (30d)",value:p(t?.totalEstimatedCost||0),icon:U,trend:"needs_attn"}),e.jsx(r,{label:"Receita Est. (MRR)",value:`$${o.toFixed(2)}`,icon:_,trend:"neutral"}),e.jsx(r,{label:"Margem Bruta Est.",value:`${u.toFixed(1)}%`,icon:$,trend:u>70?"positive":"negative"}),e.jsx(r,{label:"Tokens Processados",value:new Intl.NumberFormat("en-US",{notation:"compact"}).format(t?.totalTokens||0),icon:B,trend:"neutral"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(x,{className:"p-6 h-full border-slate-800 bg-slate-950/50",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-200 mb-6 font-display",children:"Tendência de Custo Diário"}),e.jsx("div",{className:"h-[300px] w-full",children:t&&e.jsx(N,{data:g,options:j})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(x,{className:"p-0 h-full border-slate-800 bg-slate-950/50 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-800/50 bg-slate-900/50 flex justify-between items-center",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-200 font-display uppercase tracking-wider",children:"Top Spenders"}),e.jsx("span",{className:"text-[10px] text-slate-500",children:"Últimos 30 dias"})]}),e.jsx("div",{className:"overflow-y-auto max-h-[350px]",children:e.jsx("table",{className:"w-full text-left text-xs",children:e.jsxs("tbody",{className:"divide-y divide-slate-800/50",children:[t?.topSpenders.map((s,v)=>e.jsxs("tr",{className:"hover:bg-slate-800/30 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"font-mono text-slate-500 text-[10px]",children:["#",v+1]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-slate-200",children:s.name}),e.jsxs("div",{className:"text-[10px] text-slate-500",children:[s.plan," • ",s.tenantId.substring(0,6),"..."]})]})]})}),e.jsxs("td",{className:"p-4 text-right",children:[e.jsx("div",{className:"font-mono font-bold text-violet-400",children:p(s.cost)}),e.jsxs("div",{className:"text-[10px] text-slate-500",children:[(s.tokens/1e3).toFixed(1),"k toks"]})]})]},s.tenantId)),(!t?.topSpenders||t.topSpenders.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"p-8 text-center text-slate-500",children:"Sem dados"})})]})})})]})})]})]}),h&&e.jsx(F,{onClose:()=>c(!1),onSuccess:()=>c(!1)}),e.jsx(O,{open:b,onClose:()=>m(!1)})]})}function r({label:t,value:i,icon:n,trend:l}){const d={positive:"text-emerald-500",negative:"text-rose-500",neutral:"text-slate-400",needs_attn:"text-amber-500"};return e.jsxs(x,{className:"p-5 border-slate-800 bg-slate-950/50 flex flex-col justify-between h-32 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-violet-500/5 rounded-full blur-2xl -mr-8 -mt-8 pointer-events-none group-hover:bg-violet-500/10 transition-colors"}),e.jsxs("div",{className:"flex justify-between items-start relative z-10",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest font-display",children:t}),e.jsx(n,{size:16,className:"text-slate-600"})]}),e.jsx("div",{className:`text-2xl font-black font-display tracking-tight relative z-10 ${d[l]||"text-slate-200"}`,children:i})]})}export{X as default};
