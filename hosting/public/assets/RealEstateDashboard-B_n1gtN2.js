import{a as s,j as e}from"./charts--kFkiaCp.js";import{b as w,G as U,B as z,d as me,f as K}from"./index-CETmOTzF.js";import{X as W,m as J,e as ue,I as pe,L as M,J as Z,r as T,K as he,P as _,N as H,O as be,Q as le,D as ge,Y as fe,t as je,R as te,T as ve,g as se,_ as ye,k as Ne,$ as ae,a0 as Q}from"./icons-Bc7DOyy3.js";import{u as we}from"./useTenant-BdNh_NcC.js";import{S as Se}from"./SectionHeader-DkKv0CWh.js";import{S as G}from"./StatsCard-B55lZtJ5.js";import{A as ke}from"./AsyncPanel-DLrco2Ud.js";import"./vendor-DnLjH3oN.js";import"./query-BGhlxTj0.js";import"./firebase-dP-Dck55.js";async function Ce(t=30){return(await w.get(`/realestate/portfolio-summary?days=${t}`)).data.summary}async function re(){return(await w.get("/realestate/buildings")).data.buildings}async function Ee(){return(await w.get("/realestate/units")).data.units}async function De(){return(await w.get("/realestate/owners")).data.owners}async function ze(t){return(await w.post("/realestate/owners",t)).data.owner}async function Ie(t){return(await w.post("/realestate/units",t)).data.unit}async function Pe(t){return(await w.post("/realestate/buildings",t)).data.building}async function Ae(t){return(await w.get("/realestate/contracts",{params:t?{unitId:t}:void 0})).data.contracts}async function Be(t){return(await w.post("/realestate/contracts",t)).data.contract}async function Ue(t,l){await w.put(`/realestate/contracts/${t}`,l)}const P={documents:{initUpload:async t=>(await w.post("/realestate/documents/init-upload",t)).data,commit:async t=>(await w.post("/realestate/documents/commit",t)).data,list:async t=>{const l=new URLSearchParams;return Object.entries(t||{}).forEach(([g,n])=>{n!=null&&n!==""&&l.append(g,String(n))}),(await w.get(`/realestate/documents${l.toString()?`?${l.toString()}`:""}`)).data.documents}},receivables:{generateBatch:async t=>(await w.post("/realestate/receivables/generate-batch",{period:t})).data,list:async t=>{const l=new URLSearchParams;return Object.entries(t||{}).forEach(([g,n])=>{n&&l.append(g,String(n))}),(await w.get(`/realestate/receivables${l.toString()?`?${l.toString()}`:""}`)).data.receivables},recordPayment:async(t,l,m)=>(await w.post(`/realestate/receivables/${t}/payment`,{amount:l,date:m})).data.receivable},analytics:{getAging:async()=>(await w.get("/realestate/analytics/aging")).data.aging},financial:{getReceivables:async()=>[],generateStatement:async(t,l)=>(await w.post("/realestate/statements/generate",{ownerId:t,period:l})).data,listStatements:async t=>(await w.get(`/realestate/statements?ownerId=${t}`)).data.statements}};function ne({onClose:t,onSuccess:l}){const[m,g]=s.useState(!1),[n,x]=s.useState({name:"",email:"",phone:""}),j=async i=>{if(i.preventDefault(),!!n.name.trim()){g(!0);try{await ze({name:n.name.trim(),email:n.email.trim()||void 0,phone:n.phone.trim()||void 0}),l(),t()}catch(u){console.error("Erro ao salvar proprietário:",u),alert("Erro ao salvar proprietário. Verifique os dados.")}finally{g(!1)}}};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-md rounded-2xl shadow-2xl overflow-hidden border border-slate-200 dark:border-slate-800 animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"relative bg-gradient-to-br from-primary via-primary/90 to-secondary p-6 text-white",children:[e.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-2 rounded-full bg-white/20 hover:bg-white/30 transition-colors",children:e.jsx(W,{size:16})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center shadow-glow",children:e.jsx(J,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold font-display",children:"Novo Proprietário"}),e.jsx("p",{className:"text-white/80 text-sm font-display",children:"Cadastre um novo proprietário de imóveis"})]})]})]}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-5",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 dark:text-slate-500 tracking-widest flex items-center gap-1.5 font-display",children:[e.jsx(J,{size:12})," Nome Completo *"]}),e.jsx("input",{required:!0,type:"text",placeholder:"Ex: João da Silva",value:n.name,onChange:i=>x(u=>({...u,name:i.target.value})),className:"w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all font-display"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 dark:text-slate-500 tracking-widest flex items-center gap-1.5 font-display",children:[e.jsx(ue,{size:12})," Email"]}),e.jsx("input",{type:"email",placeholder:"Ex: joao@email.com",value:n.email,onChange:i=>x(u=>({...u,email:i.target.value})),className:"w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all font-display"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 dark:text-slate-500 tracking-widest flex items-center gap-1.5 font-display",children:[e.jsx(pe,{size:12})," Telefone"]}),e.jsx("input",{type:"tel",placeholder:"Ex: (11) 99999-9999",value:n.phone,onChange:i=>x(u=>({...u,phone:i.target.value})),className:"w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all font-display"})]}),e.jsxs("div",{className:"pt-2 flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 py-3 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 font-bold text-sm hover:bg-slate-200 dark:hover:bg-slate-700 transition-all font-display",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:m||!n.name.trim(),className:"flex-[2] py-3 rounded-xl bg-primary hover:bg-primary/90 text-white font-bold text-sm shadow-glow transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 font-display",children:[m?e.jsx(M,{size:18,className:"animate-spin"}):e.jsx(Z,{size:18}),"Salvar Proprietário"]})]})]})]})})}function ie({onClose:t,onSuccess:l}){const[m,g]=s.useState(!1),[n,x]=s.useState({name:"",address:"",city:"",zipCode:""}),j=async i=>{if(i.preventDefault(),!!n.name.trim()){g(!0);try{await Pe({name:n.name.trim(),address:n.address.trim()||void 0,city:n.city.trim()||void 0,zipCode:n.zipCode.trim()||void 0,active:!0}),l(),t()}catch(u){console.error("Erro ao salvar edifício:",u),alert("Erro ao salvar edifício. Verifique os dados.")}finally{g(!1)}}};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-md rounded-2xl shadow-2xl overflow-hidden border border-slate-200 dark:border-slate-800 animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"relative bg-gradient-to-br from-slate-800 to-slate-900 p-6 text-white",children:[e.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-2 rounded-full bg-white/20 hover:bg-white/30 transition-colors",children:e.jsx(W,{size:16})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary/30 flex items-center justify-center shadow-glow",children:e.jsx(T,{size:24,className:"text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold font-display",children:"Novo Edifício"}),e.jsx("p",{className:"text-white/80 text-sm font-display",children:"Cadastre um condomínio ou prédio"})]})]})]}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-5",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 dark:text-slate-500 tracking-widest flex items-center gap-1.5 font-display",children:[e.jsx(T,{size:12})," Nome do Edifício *"]}),e.jsx("input",{required:!0,type:"text",placeholder:"Ex: Condomínio Brera",value:n.name,onChange:i=>x(u=>({...u,name:i.target.value})),className:"w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all font-display"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 dark:text-slate-500 tracking-widest flex items-center gap-1.5 font-display",children:[e.jsx(he,{size:12})," Endereço"]}),e.jsx("input",{type:"text",placeholder:"Ex: Rua dos Imóveis, 123",value:n.address,onChange:i=>x(u=>({...u,address:i.target.value})),className:"w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all font-display"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400 dark:text-slate-500 tracking-widest font-display",children:"Cidade"}),e.jsx("input",{type:"text",placeholder:"Ex: São Paulo",value:n.city,onChange:i=>x(u=>({...u,city:i.target.value})),className:"w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all font-display"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400 dark:text-slate-500 tracking-widest font-display",children:"CEP"}),e.jsx("input",{type:"text",placeholder:"Ex: 01310-100",value:n.zipCode,onChange:i=>x(u=>({...u,zipCode:i.target.value})),className:"w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all font-display"})]})]}),e.jsxs("div",{className:"pt-2 flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 py-3 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 font-bold text-sm hover:bg-slate-200 dark:hover:bg-slate-700 transition-all font-display",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:m||!n.name.trim(),className:"flex-[2] py-3 rounded-xl bg-primary hover:bg-primary/90 text-white font-bold text-sm shadow-glow transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 font-display",children:[m?e.jsx(M,{size:18,className:"animate-spin"}):e.jsx(Z,{size:18}),"Salvar Edifício"]})]})]})]})})}function Me({onClose:t,onSuccess:l}){const[m,g]=s.useState([]),[n,x]=s.useState([]),[j,i]=s.useState(!1),[u,y]=s.useState(!1),[S,N]=s.useState(!1),[k,o]=s.useState(!1),[a,v]=s.useState({code:"",name:"",buildingId:"",ownerId:""}),h=s.useCallback(async()=>{m.length===0&&n.length===0&&i(!0);try{const[f,p]=await Promise.all([re(),De()]);g(f),x(p)}catch(f){console.error("Erro ao carregar selects:",f)}finally{i(!1)}},[]);s.useEffect(()=>{h()},[h]);const I=async f=>{if(f.preventDefault(),!(!a.code||!a.ownerId)){y(!0);try{await Ie({code:a.code,name:a.name,buildingId:a.buildingId||void 0,ownerId:a.ownerId,active:!0}),l(),t()}catch(p){console.error("Erro ao salvar unidade:",p),alert("Erro ao salvar unidade. Verifique os dados.")}finally{y(!1)}}};return e.jsxs("div",{className:"fixed inset-0 z-[50] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-300",children:[e.jsxs("div",{className:"bg-white w-full max-w-lg rounded-3xl shadow-2xl overflow-hidden border border-slate-200",children:[e.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-slate-900 text-white flex items-center justify-center",children:e.jsx(_,{size:20})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 tracking-tight",children:"Nova Propriedade"}),e.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"Cadastre uma nova unidade ao seu portfólio."})]})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-200 rounded-full transition-colors text-slate-400",children:e.jsx(W,{size:20})})]}),e.jsxs("form",{onSubmit:I,className:"p-8 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-widest flex items-center gap-1.5",children:[e.jsx(H,{size:12})," Código da Unidade"]}),e.jsx("input",{required:!0,type:"text",placeholder:"Ex: 1204-A",value:a.code,onChange:f=>v(p=>({...p,code:f.target.value})),className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-500/20 outline-none transition-all font-bold"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-widest",children:"Nome Amigável"}),e.jsx("input",{type:"text",placeholder:"Ex: Brera Moema",value:a.name,onChange:f=>v(p=>({...p,name:f.target.value})),className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-500/20 outline-none transition-all"})]})]}),e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-widest flex items-center gap-1.5",children:[e.jsx(T,{size:12})," Edifício (Opcional)"]}),e.jsxs("div",{className:"flex gap-2",children:[j?e.jsx("div",{className:"h-12 w-full bg-slate-100 animate-pulse rounded-xl"}):e.jsxs("select",{value:a.buildingId,onChange:f=>v(p=>({...p,buildingId:f.target.value})),className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-500/20 outline-none transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"",children:"Nenhum (Propriedade Avulsa)"}),m.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))]}),e.jsx("button",{type:"button",onClick:()=>o(!0),className:"p-3 bg-slate-100 border border-slate-200 rounded-xl hover:bg-white hover:border-slate-300 transition-all text-slate-500 hover:text-blue-600 shadow-sm",title:"Novo Edifício",children:e.jsx(_,{size:18})})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-widest flex items-center gap-1.5",children:[e.jsx(J,{size:12})," Proprietário"]}),e.jsxs("div",{className:"flex gap-2",children:[j?e.jsx("div",{className:"h-12 w-full bg-slate-100 animate-pulse rounded-xl"}):e.jsxs("select",{required:!0,value:a.ownerId,onChange:f=>v(p=>({...p,ownerId:f.target.value})),className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-blue-500/20 outline-none transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"",children:"Selecione..."}),n.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))]}),e.jsx("button",{type:"button",onClick:()=>N(!0),className:"p-3 bg-slate-100 border border-slate-200 rounded-xl hover:bg-white hover:border-slate-300 transition-all text-slate-500 hover:text-blue-600 shadow-sm",title:"Novo Proprietário",children:e.jsx(_,{size:18})})]})]})]}),e.jsxs("div",{className:"pt-4 flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 py-3.5 rounded-2xl bg-slate-100 text-slate-600 font-bold text-sm hover:bg-slate-200 transition-all active:scale-95",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:u||!a.code||!a.ownerId,className:"flex-[2] py-3.5 rounded-2xl bg-blue-600 text-white font-bold text-sm hover:bg-blue-700 shadow-lg shadow-blue-500/20 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[u?e.jsx(M,{size:18,className:"animate-spin"}):e.jsx(Z,{size:18}),"Salvar Propriedade"]})]})]})]}),S&&e.jsx(ne,{onClose:()=>N(!1),onSuccess:h}),k&&e.jsx(ie,{onClose:()=>o(!1),onSuccess:h})]})}const Re=[{value:"contract",label:"Contrato"},{value:"inspection",label:"Vistoria"},{value:"iptu",label:"IPTU"},{value:"other",label:"Outros"}];function $e({isOpen:t,onClose:l,entityId:m,entityType:g,onSuccess:n}){const[x,j]=s.useState(null),[i,u]=s.useState(""),[y,S]=s.useState("contract"),[N,k]=s.useState(""),[o,a]=s.useState(!1),[v,h]=s.useState(null);if(!t)return null;const I=()=>{j(null),u(""),S("contract"),k(""),h(null)},f=async p=>{if(p.preventDefault(),!x){h("Selecione um arquivo.");return}if(!i.trim()){h("Informe um título.");return}a(!0),h(null);try{const b=await P.documents.initUpload({linkedEntityType:g,linkedEntityId:m,fileName:x.name,mimeType:x.type||"application/octet-stream",sizeBytes:x.size,title:i,docType:y,validUntil:N||void 0}),E=await fetch(b.uploadUrl,{method:"PUT",headers:{"Content-Type":x.type||"application/octet-stream"},body:x});if(!E.ok)throw new Error(`Falha no upload (${E.status})`);const A=await P.documents.commit({uploadSessionId:b.uploadSessionId,storagePath:b.storagePath,linkedEntityType:g,linkedEntityId:m,fileName:x.name,mimeType:x.type||"application/octet-stream",sizeBytes:x.size,title:i,docType:y,validUntil:N||void 0});n(A.document),I(),l()}catch(b){h(b?.message||"Erro ao enviar documento")}finally{a(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/50 backdrop-blur-sm px-4",children:e.jsxs(U,{className:"w-full max-w-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-slate-400 font-semibold tracking-widest",children:"GED • Upload"}),e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Novo Documento"})]}),e.jsx(z,{variant:"neutral",className:"uppercase text-[10px]",children:g})]}),e.jsxs("form",{className:"space-y-4",onSubmit:f,children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500",children:"Arquivo (PDF/Imagem)"}),e.jsx("input",{type:"file",accept:".pdf,image/*",onChange:p=>j(p.target.files?.[0]||null),className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",disabled:o,required:!0}),x&&e.jsxs("p",{className:"text-[11px] text-slate-500",children:[x.name," • ",(x.size/1024).toFixed(1)," KB"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("label",{className:"text-xs font-semibold text-slate-500 flex flex-col gap-1",children:["Título",e.jsx("input",{type:"text",value:i,onChange:p=>u(p.target.value),className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",disabled:o,required:!0})]}),e.jsxs("label",{className:"text-xs font-semibold text-slate-500 flex flex-col gap-1",children:["Tipo de Documento",e.jsx("select",{value:y,onChange:p=>S(p.target.value),className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",disabled:o,children:Re.map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))})]})]}),e.jsxs("label",{className:"text-xs font-semibold text-slate-500 flex flex-col gap-1",children:["Validade (opcional)",e.jsx("input",{type:"date",value:N,onChange:p=>k(p.target.value),className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",disabled:o})]}),v&&e.jsx("p",{className:"text-sm text-red-600",children:v}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>{I(),l()},className:"px-4 py-2 rounded-lg border border-slate-200 text-slate-600 text-sm font-semibold hover:bg-slate-50",disabled:o,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded-lg bg-blue-600 text-white text-sm font-bold shadow-sm hover:bg-blue-700 disabled:opacity-60",disabled:o,children:o?"Enviando...":"Salvar"})]})]})]})})}function oe(){const{tenantId:t}=me(),{role:l}=we(t||null),m=["admin","owner","finance","editor"].includes(l||""),g=["admin","owner","finance"].includes(l||"");return{canEdit:m,canManageFinance:g,role:l||"viewer"}}function Le({entityId:t,entityType:l}){const[m,g]=s.useState([]),[n,x]=s.useState(!0),[j,i]=s.useState(null),[u,y]=s.useState(!1),{canEdit:S}=oe(),N=async()=>{x(!0),i(null);try{const o=await P.documents.list({linkedEntityId:t,linkedEntityType:l});g(o)}catch(o){i(o?.message||"Erro ao carregar documentos")}finally{x(!1)}};s.useEffect(()=>{t&&N()},[t]);const k=o=>{g(a=>[o,...a])};return e.jsxs(U,{className:"p-4 border border-slate-200/70 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase text-slate-400 font-semibold tracking-widest",children:"GED"}),e.jsx("h4",{className:"text-lg font-bold text-slate-800",children:"Documentos da Unidade"})]}),S&&e.jsxs("button",{onClick:()=>y(!0),className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-600 text-white text-sm font-semibold shadow-sm hover:bg-blue-700",children:[e.jsx(be,{size:16}),"Novo Documento"]})]}),n&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[e.jsx(M,{className:"h-4 w-4 animate-spin text-blue-600"}),"Carregando documentos..."]}),j&&e.jsx("p",{className:"text-sm text-red-600",children:j}),!n&&!j&&m.length===0&&e.jsx("p",{className:"text-sm text-slate-500",children:"Nenhum documento cadastrado para esta entidade."}),e.jsx("div",{className:"space-y-3",children:m.map(o=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-100 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-blue-50 text-blue-700 flex items-center justify-center",children:e.jsx(le,{size:18})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-800",children:o.title}),e.jsx(z,{variant:o.status==="active"?"success":"neutral",children:o.status==="active"?"Ativo":"Arquivado"}),e.jsxs(z,{variant:"neutral",children:["v",o.version]})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[o.docType," • ",o.fileName]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o.validUntil&&e.jsxs(z,{variant:"warn",className:"text-[10px]",children:["Validade ",o.validUntil]}),e.jsx("a",{href:o.downloadUrl||void 0,target:"_blank",rel:"noreferrer",className:`px-3 py-1.5 rounded-lg border text-sm font-semibold ${o.downloadUrl?"border-blue-200 text-blue-700 hover:bg-blue-50":"border-slate-200 text-slate-400 cursor-not-allowed"}`,onClick:a=>{o.downloadUrl||a.preventDefault()},children:o.downloadUrl?"Download":"Sem URL"})]})]},o.id))}),e.jsx($e,{isOpen:u,onClose:()=>y(!1),entityId:t,entityType:l,onSuccess:k})]})}const Te=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t);function Oe({ownerId:t}){const[l,m]=s.useState(()=>{const a=new Date;return`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`}),[g,n]=s.useState([]),[x,j]=s.useState(!1),[i,u]=s.useState(!1),[y,S]=s.useState(null),N=s.useMemo(()=>{const[a,v]=l.split("-");return`${v}/${a}`},[l]),k=async()=>{j(!0),S(null);try{const a=await P.financial.listStatements(t);n(a)}catch(a){S(a?.message||"Erro ao carregar extratos")}finally{j(!1)}};s.useEffect(()=>{t&&k()},[t]);const o=async()=>{u(!0),S(null);try{const a=await P.financial.generateStatement(t,l);a?.statement&&n(v=>[a.statement,...v.filter(h=>h.id!==a.statement.id)])}catch(a){S(a?.message||"Erro ao gerar extrato")}finally{u(!1)}};return e.jsxs(U,{className:"p-4 border border-slate-200/70 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase text-slate-400 font-semibold tracking-widest",children:"Extratos"}),e.jsx("h4",{className:"text-lg font-bold text-slate-800",children:"Prestação de Contas"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"month",value:l,onChange:a=>m(a.target.value),className:"rounded-lg border border-slate-200 px-3 py-2 text-sm"}),e.jsxs("button",{onClick:o,className:"px-4 py-2 rounded-lg bg-blue-600 text-white text-sm font-semibold shadow-sm hover:bg-blue-700 disabled:opacity-60 inline-flex items-center gap-2",disabled:i,children:[i&&e.jsx(M,{className:"h-4 w-4 animate-spin"}),"Gerar"]})]})]}),y&&e.jsx("p",{className:"text-sm text-red-600",children:y}),x&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[e.jsx(M,{className:"h-4 w-4 animate-spin text-blue-600"}),"Carregando extratos..."]}),!x&&!y&&g.length===0&&e.jsx("p",{className:"text-sm text-slate-500",children:"Nenhum extrato gerado para este proprietário."}),e.jsx("div",{className:"space-y-3",children:g.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-100 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-emerald-50 text-emerald-700 flex items-center justify-center",children:e.jsx(le,{size:18})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-800",children:a.period}),e.jsx(z,{variant:a.status==="ready"?"success":"warn",children:a.status==="ready"?"Pronto":"Falhou"})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Repasse líquido: ",Te(a.totals.net||0)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{variant:"neutral",className:"text-[10px]",children:a.generatedAt?.slice(0,10)||N}),e.jsxs("a",{href:a.htmlUrl,target:"_blank",rel:"noreferrer",className:`inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border text-sm font-semibold ${a.htmlUrl?"border-emerald-200 text-emerald-700 hover:bg-emerald-50":"border-slate-200 text-slate-400 cursor-not-allowed"}`,onClick:v=>{a.htmlUrl||v.preventDefault()},children:[e.jsx(ge,{size:14}),"Ver/Imprimir"]})]})]},a.id))})]})}const X=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t);function V({label:t,value:l,color:m}){return e.jsxs("div",{className:`p-3 rounded-xl border ${m} bg-white`,children:[e.jsx("p",{className:"text-[11px] uppercase text-slate-400 font-semibold tracking-widest",children:t}),e.jsx("p",{className:"text-lg font-bold text-slate-800",children:X(l)})]})}function Fe({unitId:t,ownerId:l}){const[m,g]=s.useState([]),[n,x]=s.useState(null),[j,i]=s.useState(!1),[u,y]=s.useState(!1),[S,N]=s.useState(null),[k,o]=s.useState(()=>{const c=new Date;return`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}`}),[a,v]=s.useState(!1),{canManageFinance:h}=oe(),I=s.useMemo(()=>{const c={};return t&&(c.unitId=t),l&&(c.ownerId=l),c},[t,l]),f=async()=>{i(!0),N(null);try{const c=await P.receivables.list(I);g(c)}catch(c){N(c?.message||"Erro ao carregar cobranças")}finally{i(!1)}},p=async()=>{y(!0);try{const c=await P.analytics.getAging();x(c)}catch{}finally{y(!1)}};s.useEffect(()=>{f(),p()},[I]);const b=async()=>{v(!0),N(null);try{await P.receivables.generateBatch(k),await f(),await p()}catch(c){N(c?.message||"Erro ao gerar cobranças")}finally{v(!1)}},E=async c=>{const O=window.prompt("Valor pago (ex: 1200.00):");if(!O)return;const R=Number(O);if(Number.isNaN(R)||R<=0)return;const F=window.prompt("Data do pagamento (YYYY-MM-DD):",new Date().toISOString().slice(0,10));if(F){v(!0);try{const $=await P.receivables.recordPayment(c,R,F);g(B=>B.map(L=>L.id===c?$:L)),await p()}catch($){N($?.message||"Erro ao registrar pagamento")}finally{v(!1)}}},A=n?.buckets;return e.jsxs(U,{className:"p-4 border border-slate-200/70 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase text-slate-400 font-semibold tracking-widest",children:"Recebíveis"}),e.jsx("h4",{className:"text-lg font-bold text-slate-800",children:"Contas a Receber"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"month",value:k,onChange:c=>o(c.target.value),className:"rounded-lg border border-slate-200 px-3 py-2 text-sm"}),e.jsxs("button",{onClick:b,className:"px-4 py-2 rounded-lg bg-blue-600 text-white text-sm font-semibold shadow-sm hover:bg-blue-700 disabled:opacity-60 inline-flex items-center gap-2",disabled:a||!h,title:h?void 0:"Acesso restrito a finanças",children:[a&&e.jsx(M,{className:"h-4 w-4 animate-spin"}),"Gerar Cobranças do Mês"]})]})]}),S&&e.jsx("p",{className:"text-sm text-red-600",children:S}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsx(V,{label:"0-30 dias",value:A?.d0_30.total||0,color:"border-emerald-100"}),e.jsx(V,{label:"31-60 dias",value:A?.d31_60.total||0,color:"border-amber-100"}),e.jsx(V,{label:"61-90 dias",value:A?.d61_90.total||0,color:"border-orange-100"}),e.jsx(V,{label:"> 90 dias",value:A?.d90_plus.total||0,color:"border-red-100"})]}),j&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[e.jsx(M,{className:"h-4 w-4 animate-spin text-blue-600"}),"Carregando cobranças..."]}),!j&&m.length===0&&e.jsx("p",{className:"text-sm text-slate-500",children:"Nenhuma cobrança encontrada."}),e.jsx("div",{className:"space-y-2",children:m.map(c=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-100 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-blue-50 text-blue-700 flex items-center justify-center",children:e.jsx(fe,{size:18})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-800",children:c.unitId}),e.jsx(z,{variant:c.status==="paid"?"success":c.status==="partial"?"warn":"neutral",children:c.status})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Vencimento: ",c.dueDate," • Valor: ",X(c.amount)," • Pago:"," ",X(c.amountPaid||0)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{variant:"neutral",className:"text-[10px]",children:c.period}),h&&e.jsxs("button",{onClick:()=>E(c.id),className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-lg border border-blue-200 text-blue-700 text-sm font-semibold hover:bg-blue-50 disabled:opacity-60",disabled:a,children:[e.jsx(je,{size:14}),"Baixar"]})]})]},c.id))})]})}const Y=t=>t==null?"R$ 0,00":t.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});function We(){const[t,l]=s.useState(null),[m,g]=s.useState([]),[n,x]=s.useState([]),[j,i]=s.useState([]),[u,y]=s.useState(!0),[S,N]=s.useState(null),[k,o]=s.useState(""),[a,v]=s.useState({avulsas:!0}),[h,I]=s.useState(null),[f,p]=s.useState(!1),[b,E]=s.useState({}),[A,c]=s.useState(!1),[O,R]=s.useState(!1),[F,$]=s.useState(!1),B=s.useCallback(async()=>{y(!0),N(null);try{const[r,d,C]=await Promise.all([Ce(30),re(),Ee()]);l(r),g(d),x(C)}catch(r){console.error("[RealEstateDashboard] Erro:",r),N("Falha ao carregar dados do portfólio.")}finally{y(!1)}},[]),L=s.useCallback(async r=>{if(!r){i([]);return}const d=await Ae(r);i(d);const C=d[0];E(C?{unitId:C.unitId,tenantName:C.tenantName,startDate:C.startDate,endDate:C.endDate,rentAmount:C.rentAmount,readjustmentIndex:C.readjustmentIndex}:{unitId:r,tenantName:"",startDate:"",endDate:"",rentAmount:0,readjustmentIndex:"IGPM"})},[]);s.useEffect(()=>{B()},[B]),s.useEffect(()=>{h&&L(h.id)},[h,L]);const ee=r=>{v(d=>({...d,[r]:!d[r]}))},de=s.useMemo(()=>{const r=k.toLowerCase();return(m||[]).filter(d=>d.name.toLowerCase().includes(r))},[m,k]),q=s.useMemo(()=>{const r={};return(n||[]).forEach(d=>{const C=d.buildingId||"avulsas";r[C]||(r[C]=[]),r[C].push(d)}),r},[n]),D=s.useMemo(()=>j[0]||null,[j]),ce=s.useMemo(()=>{if(!D?.endDate)return!1;const d=new Date(D.endDate).getTime()-Date.now();return d>0&&d<720*60*60*1e3},[D]),xe=async()=>{if(!b.unitId||!b.tenantName||!b.startDate||!b.endDate||!b.rentAmount){alert("Preencha os dados do contrato.");return}p(!0);try{D?await Ue(D.id,{tenantName:b.tenantName,startDate:b.startDate,endDate:b.endDate,rentAmount:b.rentAmount,readjustmentIndex:b.readjustmentIndex}):await Be({unitId:b.unitId,tenantName:b.tenantName,startDate:b.startDate,endDate:b.endDate,rentAmount:b.rentAmount,readjustmentIndex:b.readjustmentIndex}),await L(b.unitId)}finally{p(!1)}};return e.jsxs("div",{className:"pt-24 space-y-8 pb-24 fade-in",children:[e.jsx(Se,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{size:24,className:"text-primary"}),e.jsx("span",{className:"tracking-tight font-display",children:"Portfólio Imobiliário"})]}),subtitle:"Gestão centralizada por edifícios e propriedades individuais.",actions:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:B,className:"bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 border border-slate-200 dark:border-slate-700 px-3 py-2 rounded-xl text-sm font-bold transition-all shadow-sm flex items-center gap-2 active:scale-95",title:"Atualizar",children:e.jsx(te,{size:14,className:K(u&&"animate-spin")})}),e.jsxs("button",{onClick:()=>R(!0),className:"bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 border border-slate-200 dark:border-slate-700 px-4 py-2 rounded-xl text-sm font-bold transition-all shadow-sm flex items-center gap-2 active:scale-95 font-display",children:[e.jsx(J,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Proprietário"})]}),e.jsxs("button",{onClick:()=>$(!0),className:"bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 border border-slate-200 dark:border-slate-700 px-4 py-2 rounded-xl text-sm font-bold transition-all shadow-sm flex items-center gap-2 active:scale-95 font-display",children:[e.jsx(T,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Edifício"})]}),e.jsxs("button",{onClick:()=>c(!0),className:"bg-primary hover:bg-primary/90 text-white px-4 py-2 rounded-xl text-sm font-bold transition-all shadow-glow flex items-center gap-2 active:scale-95 font-display",children:[e.jsx(_,{size:16}),"Imóvel"]})]})}),A&&e.jsx(Me,{onClose:()=>c(!1),onSuccess:B}),O&&e.jsx(ne,{onClose:()=>R(!1),onSuccess:B}),F&&e.jsx(ie,{onClose:()=>$(!1),onSuccess:B}),e.jsx(ke,{isLoading:u,error:S,isEmpty:!1,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(G,{label:"Receita Bruta (30d)",value:Y(t?.totals?.grossRevenue),icon:ve,variant:"default"}),e.jsx(G,{label:"Unidades Ativas",value:t?.totals?.activeUnits?.toString()||"0",icon:H,variant:"default"}),e.jsx(G,{label:"Lucro Operacional",value:Y(t?.totals?.netRevenue),icon:se,variant:"success"}),e.jsx(G,{label:"Booking Volume",value:t?.totals?.staysCount?.toString()||"0",icon:ye,variant:"default"})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:["Edifícios & Ativos",e.jsx(z,{variant:"neutral",children:m.length})]}),e.jsxs("div",{className:"relative w-full md:w-80",children:[e.jsx(Ne,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Buscar edifício...",value:k,onChange:r=>o(r.target.value),className:"w-full bg-white border border-slate-200 rounded-xl pl-10 pr-4 py-2 text-sm focus:ring-2 focus:ring-blue-500/20 transition-all outline-none"})]})]}),e.jsxs("div",{className:"space-y-4",children:[de.map(r=>e.jsxs("div",{className:"group",children:[e.jsxs("button",{onClick:()=>ee(r.id),className:"w-full flex items-center justify-between p-4 bg-white border border-slate-200 rounded-2xl hover:border-blue-300 transition-all shadow-sm group-hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600",children:e.jsx(T,{size:24})}),e.jsxs("div",{className:"text-left leading-tight",children:[e.jsx("h4",{className:"font-bold text-slate-900",children:r.name}),e.jsx("p",{className:"text-xs text-slate-500",children:r.address||"Sem endereço cadastrado"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"hidden md:block text-right",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-widest",children:"Unidades"}),e.jsx("p",{className:"font-bold text-slate-700",children:q[r.id]?.length||0})]}),a[r.id]?e.jsx(ae,{className:"text-slate-400"}):e.jsx(Q,{className:"text-slate-400"})]})]}),a[r.id]&&e.jsx("div",{className:"mt-2 ml-6 pl-6 border-l-2 border-slate-100 space-y-2 animate-in slide-in-from-top-2 duration-300",children:q[r.id]?.map(d=>e.jsxs("div",{className:K("flex items-center justify-between p-3 bg-slate-50/50 rounded-xl border border-slate-100/50 hover:bg-slate-50 transition-colors",h?.id===d.id&&"ring-2 ring-blue-200"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{variant:d.active?"success":"neutral",children:d.code}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:d.name||"Sem nome"})]}),e.jsx("button",{className:"text-xs font-bold text-blue-600 hover:text-blue-700",onClick:()=>{I(d),E(C=>({...C,unitId:d.id}))},children:"DETALHES"})]},d.id))||e.jsx("p",{className:"text-xs text-slate-400 italic",children:"Nenhuma unidade vinculada."})})]},r.id)),e.jsxs("div",{className:"group",children:[e.jsxs("button",{onClick:()=>ee("avulsas"),className:"w-full flex items-center justify-between p-4 bg-slate-50 border border-dashed border-slate-300 rounded-2xl hover:border-slate-400 transition-all shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-slate-200 flex items-center justify-center text-slate-500",children:e.jsx(H,{size:24})}),e.jsxs("div",{className:"text-left leading-tight",children:[e.jsx("h4",{className:"font-bold text-slate-700 tracking-tight",children:"Propriedades Avulsas"}),e.jsx("p",{className:"text-xs text-slate-500 italic",children:"Unidades sem edifício vinculado"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"hidden md:block text-right",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-widest",children:"Contagem"}),e.jsx("p",{className:"font-bold text-slate-600",children:q.avulsas?.length||0})]}),a.avulsas?e.jsx(ae,{className:"text-slate-400"}):e.jsx(Q,{className:"text-slate-400"})]})]}),a.avulsas&&e.jsx("div",{className:"mt-2 ml-6 pl-6 border-l-2 border-slate-100 space-y-2 animate-in slide-in-from-top-2 duration-300",children:q.avulsas?.map(r=>e.jsxs("div",{className:K("flex items-center justify-between p-3 bg-white rounded-xl border border-slate-100 hover:shadow-sm transition-all",h?.id===r.id&&"ring-2 ring-blue-200"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{variant:r.active?"success":"neutral",children:r.code}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:r.name||"Sem nome"})]}),e.jsx("button",{className:"text-xs font-bold text-blue-600 hover:text-blue-700",onClick:()=>{I(r),E(d=>({...d,unitId:r.id}))},children:"DETALHES"})]},r.id))})]})]})]}),h&&e.jsxs(e.Fragment,{children:[e.jsxs(U,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(H,{size:18,className:"text-primary"}),h.name||h.code]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Contrato ativo e status do inquilino."})]}),e.jsx(z,{variant:h.active?"success":"neutral",children:h.active?"Ativa":"Inativa"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs(U,{className:"p-4 border border-slate-200/70",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-bold text-slate-800",children:"Contrato Ativo"}),ce&&e.jsx(z,{variant:"warn",children:"Vencendo em breve"})]}),D?e.jsxs("div",{className:"space-y-2 text-sm text-slate-700",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Inquilino:"})," ",D.tenantName]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Período:"})," ",D.startDate," → ",D.endDate]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Aluguel:"})," ",Y(D.rentAmount)]}),D.readjustmentIndex&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Índice:"})," ",D.readjustmentIndex]})]}):e.jsx("p",{className:"text-sm text-slate-500",children:"Nenhum contrato cadastrado para esta unidade."})]}),e.jsxs(U,{className:"p-4 border border-slate-200/70",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-bold text-slate-800",children:D?"Renovar Contrato":"Criar Contrato"}),f&&e.jsx(te,{size:16,className:"animate-spin text-slate-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("label",{className:"text-xs text-slate-500 font-semibold",children:["Inquilino",e.jsx("input",{type:"text",value:b.tenantName||"",onChange:r=>E(d=>({...d,tenantName:r.target.value})),className:"w-full mt-1 rounded-lg border border-slate-200 px-3 py-2 text-sm"})]}),e.jsxs("label",{className:"text-xs text-slate-500 font-semibold",children:["Aluguel",e.jsx("input",{type:"number",value:b.rentAmount??"",onChange:r=>E(d=>({...d,rentAmount:Number(r.target.value)})),className:"w-full mt-1 rounded-lg border border-slate-200 px-3 py-2 text-sm"})]}),e.jsxs("label",{className:"text-xs text-slate-500 font-semibold",children:["Início",e.jsx("input",{type:"date",value:b.startDate||"",onChange:r=>E(d=>({...d,startDate:r.target.value})),className:"w-full mt-1 rounded-lg border border-slate-200 px-3 py-2 text-sm"})]}),e.jsxs("label",{className:"text-xs text-slate-500 font-semibold",children:["Fim",e.jsx("input",{type:"date",value:b.endDate||"",onChange:r=>E(d=>({...d,endDate:r.target.value})),className:"w-full mt-1 rounded-lg border border-slate-200 px-3 py-2 text-sm"})]}),e.jsxs("label",{className:"text-xs text-slate-500 font-semibold",children:["Índice de Reajuste",e.jsxs("select",{value:b.readjustmentIndex||"IGPM",onChange:r=>E(d=>({...d,readjustmentIndex:r.target.value})),className:"w-full mt-1 rounded-lg border border-slate-200 px-3 py-2 text-sm",children:[e.jsx("option",{value:"IGPM",children:"IGPM"}),e.jsx("option",{value:"IPCA",children:"IPCA"})]})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{onClick:xe,disabled:f,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-bold shadow-sm hover:bg-blue-700 disabled:opacity-60",children:D?"Renovar Contrato":"Criar Contrato"})})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(Le,{entityId:h.id,entityType:"unit"})}),e.jsx("div",{className:"mt-4",children:e.jsx(Oe,{ownerId:h.ownerId})}),e.jsx("div",{className:"mt-4",children:e.jsx(Fe,{unitId:h.id,ownerId:h.ownerId})})]}),t?.potentialCharges&&e.jsx(U,{className:"p-6 border-slate-200 shadow-xl shadow-slate-200/40",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{className:"space-y-1 text-center md:text-left",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 tracking-tight flex items-center gap-2 justify-center md:justify-start",children:[e.jsx(se,{className:"text-emerald-500",size:20}),"Billing Preview"]}),e.jsxs("p",{className:"text-sm text-slate-500 max-w-lg",children:["Estimativa mensal baseada na volumetria atual do seu portfólio (",t.totals.activeOwners," proprietários e ",t.totals.activeUnits," unidades)."]})]}),e.jsxs("div",{className:"flex items-center gap-8 bg-white p-3 rounded-2xl border border-slate-100 shadow-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-widest",children:"Base Mensal"}),e.jsx("p",{className:"text-xl font-black text-slate-900 tracking-tighter",children:Y(t.potentialCharges.total)})]}),e.jsx(Q,{size:20,className:"text-slate-200"}),e.jsx("button",{className:"px-5 py-2.5 bg-blue-600 text-white rounded-xl font-bold text-sm shadow-lg shadow-blue-500/20 hover:bg-blue-700 active:scale-95 transition-all",children:"Upgrade Pro"})]})]})})]})}export{We as default};
